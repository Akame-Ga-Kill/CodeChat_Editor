{"version":3,"file":"script-editor.min.js","sources":["../src/script-editor.js","../src/prism/prism-core.js","../src/prism/prism-line-numbers.js","../src/prism/prism-match-braces.js","../src/prism/prism-graphviz.js","../src/codejar/codejar.js"],"sourcesContent":["import { CodeJar } from './codejar/codejar'\r\nimport Prism from './prism/prism-core'\r\nimport lightTheme from './prism/prism-light.css'\r\nimport lineNumbersStyle from './prism/prism-line-numbers.css'\r\nimport matchBracesStyle from './prism/prism-match-braces.css'\r\nimport mainStyle from './script-editor.css'\r\nimport './prism/prism-line-numbers'\r\nimport './prism/prism-match-braces'\r\nimport './prism/prism-graphviz'\r\n\r\nconst features = ['line-numbers', 'match-braces', 'rainbow-braces']\r\nconst connectedKey = Symbol('connecte')\r\nconst valueKey = Symbol('value')\r\nconst tabKey = Symbol('tab')\r\nconst classKey = Symbol('class')\r\nconst jarKey = Symbol('jar')\r\nconst widthKey = Symbol('width')\r\nconst heightKey = Symbol('height')\r\nconst mousedownKey = Symbol('mousedown')\r\nconst mouseupKey = Symbol('mouseup')\r\nlet template, pendingAllLineNumbersUpdate\r\n\r\nPrism.codeTag = 'div'\r\n\r\nfunction getTemplate () {\r\n  if (!template) {\r\n    template = document.createElement('template')\r\n    template.innerHTML = `<style>\r\n${lightTheme}\r\n${lineNumbersStyle}\r\n${matchBracesStyle}\r\n${mainStyle}\r\n</style>\r\n<pre id=source-wrapper><div id=source></div></pre>`\r\n  }\r\n  return template\r\n}\r\n\r\nfunction triggerEvent (element, type, detail) {\r\n  element.dispatchEvent(new CustomEvent(type, { detail }))\r\n}\r\n\r\nfunction getFeatureClasses (element) {\r\n  return element.className\r\n    .trim()\r\n    .split(/\\s+/)\r\n    .filter(feature => features.includes(feature))\r\n    .join(' ')\r\n}\r\n\r\nfunction hasChangedFeatureClass (oldValue, newValue) {\r\n  const oldClasses = oldValue ? oldValue.trim().split(/\\s+/) : []\r\n  const newClasses = newValue.trim().split(/\\s+/)\r\n  return features.some(feature =>\r\n    oldClasses.includes(feature) !== newClasses.includes(feature))\r\n}\r\n\r\nfunction normalizeLineBreaks (value) {\r\n  return value.replace(/\\r?\\n/, '\\n')\r\n}\r\n\r\nfunction createEditor (element) {\r\n  const ownerRoot = element.shadowRoot\r\n  const source = ownerRoot.getElementById('source')\r\n  const featureClasses = getFeatureClasses(element)\r\n  source.className = `language-graphviz ${featureClasses}`\r\n  const jar = element[jarKey] = CodeJar(source, Prism.highlightElement, { tab: element.tab, ownerRoot })\r\n  updateEditor(element)\r\n  jar.onUpdate(newCode => {\r\n    newCode = normalizeLineBreaks(newCode)\r\n    if (element.value !== newCode) {\r\n      element[valueKey] = newCode\r\n      triggerEvent(element, 'input', newCode)\r\n    }\r\n  })\r\n}\r\n\r\nfunction destroyEditor (element) {\r\n  element[jarKey].destroy()\r\n  element[jarKey] = null\r\n}\r\n\r\nfunction rebuildEditor (element) {\r\n  destroyEditor(element)\r\n  createEditor(element)\r\n}\r\n\r\nfunction updateEditor (element) {\r\n  element[jarKey].updateCode(element.value)\r\n}\r\n\r\nfunction configureEditor (element) {\r\n  element[jarKey].updateOptions({ tab: element.tab })\r\n}\r\n\r\nclass GraphvizScriptEditorElement extends HTMLElement {\r\n  constructor () {\r\n    super()\r\n    this[valueKey] = ''\r\n    this[tabKey] = '  '\r\n    this[classKey] = ''\r\n    this.attachShadow({ mode: 'open' })\r\n    this.shadowRoot.appendChild(getTemplate().content.cloneNode(true))\r\n  }\r\n\r\n  get value () { return this[valueKey] }\r\n  set value (value) { this.setAttribute('value', value) }\r\n\r\n  get tab () { return this[tabKey] }\r\n  set tab (value) { this.setAttribute('tab', value) }\r\n\r\n  get className () { return this[classKey] }\r\n  set className (value) { this.setAttribute('class', value) }\r\n\r\n  attributeChangedCallback (name, oldValue, newValue) {\r\n    switch (name) {\r\n      case 'value':\r\n        this[valueKey] = normalizeLineBreaks(newValue)\r\n        if (this[connectedKey]) updateEditor(this)\r\n        break\r\n      case 'tab':\r\n        this[tabKey] = newValue\r\n        if (this[connectedKey]) configureEditor(this)\r\n        break\r\n      case 'class':\r\n        this[classKey] = newValue\r\n        if (this[connectedKey] && hasChangedFeatureClass(oldValue, newValue)) rebuildEditor(this)\r\n        break\r\n    }\r\n  }\r\n\r\n  connectedCallback () {\r\n    registerEvents(this)\r\n    createEditor(this)\r\n    this[connectedKey] = true\r\n  }\r\n\r\n  disconnectedCallback () {\r\n    destroyEditor(this)\r\n    unregisterEvents(this)\r\n    this[connectedKey] = false\r\n  }\r\n\r\n  static get observedAttributes () { return ['value', 'tab', 'class'] }\r\n}\r\n\r\nfunction rememberSize (element) {\r\n  element[widthKey] = element.clientWidth\r\n  element[heightKey] = element.clientHeight\r\n}\r\n\r\nfunction updateLineNumbers (element) {\r\n  const newWidth = element.clientWidth\r\n  const newHeight = element.clientHeight\r\n  if (newWidth !== element[widthKey] || newHeight !== element[heightKey]) {\r\n    Prism.plugins.lineNumbers.updateLineNumbers(element.shadowRoot.getElementById('source-wrapper'))\r\n    element[widthKey] = newWidth\r\n    element[heightKey] = newHeight\r\n  }\r\n}\r\n\r\nfunction registerEvents (element) {\r\n  const mousedown = element[mousedownKey] = () => rememberSize(element)\r\n  const mouseup = element[mouseupKey] = () => updateLineNumbers(element)\r\n  element.addEventListener('mousedown', mousedown)\r\n  element.addEventListener('mouseup', mouseup)\r\n}\r\n\r\nfunction unregisterEvents (element) {\r\n  element.removeEventListener('mouseup', element[mouseupKey])\r\n  element.removeEventListener('mousedown', element[mousedownKey])\r\n}\r\n\r\nfunction updateAllLineNumbers () {\r\n  clearTimeout(pendingAllLineNumbersUpdate)\r\n  const editors = document.querySelectorAll('graphviz-script-editor.line-numbers')\r\n  for (const editor of editors) updateLineNumbers(editor)\r\n}\r\n\r\nfunction scheduleUpdateAllLineNumbers () {\r\n  if (pendingAllLineNumbersUpdate) clearTimeout(pendingAllLineNumbersUpdate)\r\n  pendingAllLineNumbersUpdate = setTimeout(updateAllLineNumbers, 300)\r\n}\r\n\r\naddEventListener('resize', scheduleUpdateAllLineNumbers)\r\n\r\ncustomElements.define('graphviz-script-editor', GraphvizScriptEditorElement)\r\n\r\nexport default GraphvizScriptEditorElement\r\n","/**\r\n * Prism: Lightweight, robust, elegant syntax highlighting\r\n * MIT license http://www.opensource.org/licenses/mit-license.php/\r\n * @author Lea Verou http://lea.verou.me\r\n */\r\n\r\n// Private helper vars\r\nvar lang = /\\blang(?:uage)?-([\\w-]+)\\b/i;\r\nvar uniqueId = 0;\r\n\r\nvar _\r\nexport default _ = {\r\n\tcodeTag: 'code',\r\n\r\n\tutil: {\r\n\t\tencode: function encode(tokens) {\r\n\t\t\tif (tokens instanceof Token) {\r\n\t\t\t\treturn new Token(tokens.type, encode(tokens.content), tokens.alias);\r\n\t\t\t} else if (Array.isArray(tokens)) {\r\n\t\t\t\treturn tokens.map(encode);\r\n\t\t\t} else {\r\n\t\t\t\treturn tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\u00a0/g, ' ');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttype: function (o) {\r\n\t\t\treturn Object.prototype.toString.call(o).slice(8, -1);\r\n\t\t},\r\n\r\n\t\tobjId: function (obj) {\r\n\t\t\tif (!obj['__id']) {\r\n\t\t\t\tObject.defineProperty(obj, '__id', { value: ++uniqueId });\r\n\t\t\t}\r\n\t\t\treturn obj['__id'];\r\n\t\t},\r\n\r\n\t\t// Deep clone a language definition (e.g. to extend it)\r\n\t\tclone: function deepClone(o, visited) {\r\n\t\t\tvar clone, id, type = _.util.type(o);\r\n\t\t\tvisited = visited || {};\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase 'Object':\r\n\t\t\t\t\tid = _.util.objId(o);\r\n\t\t\t\t\tif (visited[id]) {\r\n\t\t\t\t\t\treturn visited[id];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclone = {};\r\n\t\t\t\t\tvisited[id] = clone;\r\n\r\n\t\t\t\t\tfor (var key in o) {\r\n\t\t\t\t\t\tif (o.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\tclone[key] = deepClone(o[key], visited);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn clone;\r\n\r\n\t\t\t\tcase 'Array':\r\n\t\t\t\t\tid = _.util.objId(o);\r\n\t\t\t\t\tif (visited[id]) {\r\n\t\t\t\t\t\treturn visited[id];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclone = [];\r\n\t\t\t\t\tvisited[id] = clone;\r\n\r\n\t\t\t\t\to.forEach(function (v, i) {\r\n\t\t\t\t\t\tclone[i] = deepClone(v, visited);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn clone;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn o;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Returns the Prism language of the given element set by a `language-xxxx` or `lang-xxxx` class.\r\n\t\t *\r\n\t\t * If no language is set for the element or the element is `null` or `undefined`, `none` will be returned.\r\n\t\t *\r\n\t\t * @param {Element} element\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\tgetLanguage: function (element) {\r\n\t\t\twhile (element && !lang.test(element.className)) {\r\n\t\t\t\telement = element.parentElement;\r\n\t\t\t}\r\n\t\t\tif (element) {\r\n\t\t\t\treturn (element.className.match(lang) || [, 'none'])[1].toLowerCase();\r\n\t\t\t}\r\n\t\t\treturn 'none';\r\n\t\t}\r\n\t},\r\n\r\n\tlanguages: {\r\n\t\textend: function (id, redef) {\r\n\t\t\tvar lang = _.util.clone(_.languages[id]);\r\n\r\n\t\t\tfor (var key in redef) {\r\n\t\t\t\tlang[key] = redef[key];\r\n\t\t\t}\r\n\r\n\t\t\treturn lang;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Insert a token before another token in a language literal\r\n\t\t * As this needs to recreate the object (we cannot actually insert before keys in object literals),\r\n\t\t * we cannot just provide an object, we need an object and a key.\r\n\t\t * @param inside The key (or language id) of the parent\r\n\t\t * @param before The key to insert before.\r\n\t\t * @param insert Object with the key/value pairs to insert\r\n\t\t * @param root The object that contains `inside`. If equal to Prism.languages, it can be omitted.\r\n\t\t */\r\n\t\tinsertBefore: function (inside, before, insert, root) {\r\n\t\t\troot = root || _.languages;\r\n\t\t\tvar grammar = root[inside];\r\n\t\t\tvar ret = {};\r\n\r\n\t\t\tfor (var token in grammar) {\r\n\t\t\t\tif (grammar.hasOwnProperty(token)) {\r\n\r\n\t\t\t\t\tif (token == before) {\r\n\t\t\t\t\t\tfor (var newToken in insert) {\r\n\t\t\t\t\t\t\tif (insert.hasOwnProperty(newToken)) {\r\n\t\t\t\t\t\t\t\tret[newToken] = insert[newToken];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Do not insert token which also occur in insert. See #1525\r\n\t\t\t\t\tif (!insert.hasOwnProperty(token)) {\r\n\t\t\t\t\t\tret[token] = grammar[token];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar old = root[inside];\r\n\t\t\troot[inside] = ret;\r\n\r\n\t\t\t// Update references in other language definitions\r\n\t\t\t_.languages.DFS(_.languages, function(key, value) {\r\n\t\t\t\tif (value === old && key != inside) {\r\n\t\t\t\t\tthis[key] = ret;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn ret;\r\n\t\t},\r\n\r\n\t\t// Traverse a language definition with Depth First Search\r\n\t\tDFS: function DFS(o, callback, type, visited) {\r\n\t\t\tvisited = visited || {};\r\n\r\n\t\t\tvar objId = _.util.objId;\r\n\r\n\t\t\tfor (var i in o) {\r\n\t\t\t\tif (o.hasOwnProperty(i)) {\r\n\t\t\t\t\tcallback.call(o, i, o[i], type || i);\r\n\r\n\t\t\t\t\tvar property = o[i],\r\n\t\t\t\t\t    propertyType = _.util.type(property);\r\n\r\n\t\t\t\t\tif (propertyType === 'Object' && !visited[objId(property)]) {\r\n\t\t\t\t\t\tvisited[objId(property)] = true;\r\n\t\t\t\t\t\tDFS(property, callback, null, visited);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (propertyType === 'Array' && !visited[objId(property)]) {\r\n\t\t\t\t\t\tvisited[objId(property)] = true;\r\n\t\t\t\t\t\tDFS(property, callback, i, visited);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tplugins: {},\r\n\r\n\thighlightElement: function(element, callback) {\r\n\t\t// Find language\r\n\t\tvar language = _.util.getLanguage(element);\r\n\t\tvar grammar = _.languages[language];\r\n\r\n\t\t// Set language on the element, if not present\r\n\t\telement.className = element.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\r\n\r\n\t\t// Set language on the parent, for styling\r\n\t\tvar parent = element.parentNode;\r\n\t\tif (parent && parent.nodeName.toLowerCase() === 'pre') {\r\n\t\t\tparent.className = parent.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\r\n\t\t}\r\n\r\n\t\tvar code = element.textContent;\r\n\r\n\t\tvar env = {\r\n\t\t\telement: element,\r\n\t\t\tlanguage: language,\r\n\t\t\tgrammar: grammar,\r\n\t\t\tcode: code\r\n\t\t};\r\n\r\n\t\tfunction insertHighlightedCode(highlightedCode) {\r\n\t\t\tenv.highlightedCode = highlightedCode;\r\n\r\n\t\t\t_.hooks.run('before-insert', env);\r\n\r\n\t\t\tenv.element.innerHTML = env.highlightedCode;\r\n\r\n\t\t\t_.hooks.run('after-highlight', env);\r\n\t\t\t_.hooks.run('complete', env);\r\n\t\t\tcallback && callback.call(env.element);\r\n\t\t}\r\n\r\n\t\t_.hooks.run('before-sanity-check', env);\r\n\r\n\t\tif (!env.code) {\r\n\t\t\t_.hooks.run('complete', env);\r\n\t\t\tcallback && callback.call(env.element);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_.hooks.run('before-highlight', env);\r\n\r\n\t\tif (!env.grammar) {\r\n\t\t\tinsertHighlightedCode(_.util.encode(env.code));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tinsertHighlightedCode(_.highlight(env.code, env.grammar, env.language));\r\n\t},\r\n\r\n\thighlight: function (text, grammar, language) {\r\n\t\tvar env = {\r\n\t\t\tcode: text,\r\n\t\t\tgrammar: grammar,\r\n\t\t\tlanguage: language\r\n\t\t};\r\n\t\t_.hooks.run('before-tokenize', env);\r\n\t\tenv.tokens = _.tokenize(env.code, env.grammar);\r\n\t\t_.hooks.run('after-tokenize', env);\r\n\t\treturn Token.stringify(_.util.encode(env.tokens), env.language);\r\n\t},\r\n\r\n\ttokenize: function(text, grammar) {\r\n\t\tvar rest = grammar.rest;\r\n\t\tif (rest) {\r\n\t\t\tfor (var token in rest) {\r\n\t\t\t\tgrammar[token] = rest[token];\r\n\t\t\t}\r\n\r\n\t\t\tdelete grammar.rest;\r\n\t\t}\r\n\r\n\t\tvar tokenList = new LinkedList();\r\n\t\taddAfter(tokenList, tokenList.head, text);\r\n\r\n\t\tmatchGrammar(text, tokenList, grammar, tokenList.head, 0);\r\n\r\n\t\treturn toArray(tokenList);\r\n\t},\r\n\r\n\thooks: {\r\n\t\tall: {},\r\n\r\n\t\tadd: function (name, callback) {\r\n\t\t\tvar hooks = _.hooks.all;\r\n\r\n\t\t\thooks[name] = hooks[name] || [];\r\n\r\n\t\t\thooks[name].push(callback);\r\n\t\t},\r\n\r\n\t\trun: function (name, env) {\r\n\t\t\tvar callbacks = _.hooks.all[name];\r\n\r\n\t\t\tif (!callbacks || !callbacks.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i=0, callback; callback = callbacks[i++];) {\r\n\t\t\t\tcallback(env);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tToken: Token\r\n};\r\n\r\nfunction Token(type, content, alias, matchedStr, greedy) {\r\n\tthis.type = type;\r\n\tthis.content = content;\r\n\tthis.alias = alias;\r\n\t// Copy of the full string this token was created from\r\n\tthis.length = (matchedStr || '').length|0;\r\n\tthis.greedy = !!greedy;\r\n}\r\n\r\nToken.stringify = function stringify(o, language) {\r\n\tif (typeof o == 'string') {\r\n\t\treturn o;\r\n\t}\r\n\tif (Array.isArray(o)) {\r\n\t\tvar s = '';\r\n\t\to.forEach(function (e) {\r\n\t\t\ts += stringify(e, language);\r\n\t\t});\r\n\t\treturn s;\r\n\t}\r\n\r\n\tvar env = {\r\n\t\ttype: o.type,\r\n\t\tcontent: stringify(o.content, language),\r\n\t\ttag: 'span',\r\n\t\tclasses: ['token', o.type],\r\n\t\tattributes: {},\r\n\t\tlanguage: language\r\n\t};\r\n\r\n\tvar aliases = o.alias;\r\n\tif (aliases) {\r\n\t\tif (Array.isArray(aliases)) {\r\n\t\t\tArray.prototype.push.apply(env.classes, aliases);\r\n\t\t} else {\r\n\t\t\tenv.classes.push(aliases);\r\n\t\t}\r\n\t}\r\n\r\n\t_.hooks.run('wrap', env);\r\n\r\n\tvar attributes = '';\r\n\tfor (var name in env.attributes) {\r\n\t\tattributes += ' ' + name + '=\"' + (env.attributes[name] || '').replace(/\"/g, '&quot;') + '\"';\r\n\t}\r\n\r\n\treturn '<' + env.tag + ' class=\"' + env.classes.join(' ') + '\"' + attributes + '>' + env.content + '</' + env.tag + '>';\r\n};\r\n\r\n/**\r\n * @param {string} text\r\n * @param {LinkedList<string | Token>} tokenList\r\n * @param {any} grammar\r\n * @param {LinkedListNode<string | Token>} startNode\r\n * @param {number} startPos\r\n * @param {boolean} [oneshot=false]\r\n * @param {string} [target]\r\n */\r\nfunction matchGrammar(text, tokenList, grammar, startNode, startPos, oneshot, target) {\r\n\tfor (var token in grammar) {\r\n\t\tif (!grammar.hasOwnProperty(token) || !grammar[token]) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar patterns = grammar[token];\r\n\t\tpatterns = Array.isArray(patterns) ? patterns : [patterns];\r\n\r\n\t\tfor (var j = 0; j < patterns.length; ++j) {\r\n\t\t\tif (target && target == token + ',' + j) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar pattern = patterns[j],\r\n\t\t\t\tinside = pattern.inside,\r\n\t\t\t\tlookbehind = !!pattern.lookbehind,\r\n\t\t\t\tgreedy = !!pattern.greedy,\r\n\t\t\t\tlookbehindLength = 0,\r\n\t\t\t\talias = pattern.alias;\r\n\r\n\t\t\tif (greedy && !pattern.pattern.global) {\r\n\t\t\t\t// Without the global flag, lastIndex won't work\r\n\t\t\t\tvar flags = pattern.pattern.toString().match(/[imsuy]*$/)[0];\r\n\t\t\t\tpattern.pattern = RegExp(pattern.pattern.source, flags + 'g');\r\n\t\t\t}\r\n\r\n\t\t\tpattern = pattern.pattern || pattern;\r\n\r\n\t\t\tfor ( // iterate the token list and keep track of the current token/string position\r\n\t\t\t\tvar currentNode = startNode.next, pos = startPos;\r\n\t\t\t\tcurrentNode !== tokenList.tail;\r\n\t\t\t\tpos += currentNode.value.length, currentNode = currentNode.next\r\n\t\t\t) {\r\n\r\n\t\t\t\tvar str = currentNode.value;\r\n\r\n\t\t\t\tif (tokenList.length > text.length) {\r\n\t\t\t\t\t// Something went terribly wrong, ABORT, ABORT!\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (str instanceof Token) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar removeCount = 1; // this is the to parameter of removeBetween\r\n\r\n\t\t\t\tif (greedy && currentNode != tokenList.tail.prev) {\r\n\t\t\t\t\tpattern.lastIndex = pos;\r\n\t\t\t\t\tvar match = pattern.exec(text);\r\n\t\t\t\t\tif (!match) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar from = match.index + (lookbehind && match[1] ? match[1].length : 0);\r\n\t\t\t\t\tvar to = match.index + match[0].length;\r\n\t\t\t\t\tvar p = pos;\r\n\r\n\t\t\t\t\t// find the node that contains the match\r\n\t\t\t\t\tp += currentNode.value.length;\r\n\t\t\t\t\twhile (from >= p) {\r\n\t\t\t\t\t\tcurrentNode = currentNode.next;\r\n\t\t\t\t\t\tp += currentNode.value.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// adjust pos (and p)\r\n\t\t\t\t\tp -= currentNode.value.length;\r\n\t\t\t\t\tpos = p;\r\n\r\n\t\t\t\t\t// the current node is a Token, then the match starts inside another Token, which is invalid\r\n\t\t\t\t\tif (currentNode.value instanceof Token) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// find the last node which is affected by this match\r\n\t\t\t\t\tfor (\r\n\t\t\t\t\t\tvar k = currentNode;\r\n\t\t\t\t\t\tk !== tokenList.tail && (p < to || (typeof k.value === 'string' && !k.prev.value.greedy));\r\n\t\t\t\t\t\tk = k.next\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tremoveCount++;\r\n\t\t\t\t\t\tp += k.value.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tremoveCount--;\r\n\r\n\t\t\t\t\t// replace with the new match\r\n\t\t\t\t\tstr = text.slice(pos, p);\r\n\t\t\t\t\tmatch.index -= pos;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpattern.lastIndex = 0;\r\n\r\n\t\t\t\t\tvar match = pattern.exec(str);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!match) {\r\n\t\t\t\t\tif (oneshot) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (lookbehind) {\r\n\t\t\t\t\tlookbehindLength = match[1] ? match[1].length : 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar from = match.index + lookbehindLength,\r\n\t\t\t\t\tmatch = match[0].slice(lookbehindLength),\r\n\t\t\t\t\tto = from + match.length,\r\n\t\t\t\t\tbefore = str.slice(0, from),\r\n\t\t\t\t\tafter = str.slice(to);\r\n\r\n\t\t\t\tvar removeFrom = currentNode.prev;\r\n\r\n\t\t\t\tif (before) {\r\n\t\t\t\t\tremoveFrom = addAfter(tokenList, removeFrom, before);\r\n\t\t\t\t\tpos += before.length;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tremoveRange(tokenList, removeFrom, removeCount);\r\n\r\n\t\t\t\tvar wrapped = new Token(token, inside ? _.tokenize(match, inside) : match, alias, match, greedy);\r\n\t\t\t\tcurrentNode = addAfter(tokenList, removeFrom, wrapped);\r\n\r\n\t\t\t\tif (after) {\r\n\t\t\t\t\taddAfter(tokenList, currentNode, after);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif (removeCount > 1)\r\n\t\t\t\t\tmatchGrammar(text, tokenList, grammar, currentNode.prev, pos, true, token + ',' + j);\r\n\r\n\t\t\t\tif (oneshot)\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @typedef LinkedListNode\r\n * @property {T} value\r\n * @property {LinkedListNode<T> | null} prev The previous node.\r\n * @property {LinkedListNode<T> | null} next The next node.\r\n * @template T\r\n */\r\n\r\n/**\r\n * @template T\r\n */\r\nfunction LinkedList() {\r\n\t/** @type {LinkedListNode<T>} */\r\n\tvar head = { value: null, prev: null, next: null };\r\n\t/** @type {LinkedListNode<T>} */\r\n\tvar tail = { value: null, prev: head, next: null };\r\n\thead.next = tail;\r\n\r\n\t/** @type {LinkedListNode<T>} */\r\n\tthis.head = head;\r\n\t/** @type {LinkedListNode<T>} */\r\n\tthis.tail = tail;\r\n\tthis.length = 0;\r\n}\r\n\r\n/**\r\n * Adds a new node with the given value to the list.\r\n * @param {LinkedList<T>} list\r\n * @param {LinkedListNode<T>} node\r\n * @param {T} value\r\n * @returns {LinkedListNode<T>} The added node.\r\n * @template T\r\n */\r\nfunction addAfter(list, node, value) {\r\n\t// assumes that node != list.tail && values.length >= 0\r\n\tvar next = node.next;\r\n\r\n\tvar newNode = { value: value, prev: node, next: next };\r\n\tnode.next = newNode;\r\n\tnext.prev = newNode;\r\n\tlist.length++;\r\n\r\n\treturn newNode;\r\n}\r\n/**\r\n * Removes `count` nodes after the given node. The given node will not be removed.\r\n * @param {LinkedList<T>} list\r\n * @param {LinkedListNode<T>} node\r\n * @param {number} count\r\n * @template T\r\n */\r\nfunction removeRange(list, node, count) {\r\n\tvar next = node.next;\r\n\tfor (var i = 0; i < count && next !== list.tail; i++) {\r\n\t\tnext = next.next;\r\n\t}\r\n\tnode.next = next;\r\n\tnext.prev = node;\r\n\tlist.length -= i;\r\n}\r\n/**\r\n * @param {LinkedList<T>} list\r\n * @returns {T[]}\r\n * @template T\r\n */\r\nfunction toArray(list) {\r\n\tvar array = [];\r\n\tvar node = list.head.next;\r\n\twhile (node !== list.tail) {\r\n\t\tarray.push(node.value);\r\n\t\tnode = node.next;\r\n\t}\r\n\treturn array;\r\n}\r\n","import Prism from './prism-core'\r\n\r\n/**\r\n * Plugin name which is used as a class name for <pre> which is activating the plugin\r\n * @type {String}\r\n */\r\nvar PLUGIN_NAME = 'line-numbers';\r\n\r\n/**\r\n * Regular expression used for determining line breaks\r\n * @type {RegExp}\r\n */\r\nvar NEW_LINE_EXP = /\\n(?!$)/g;\r\n\r\n/**\r\n * Resizes line numbers spans according to height of line of code\r\n * @param {Element} element <pre> element\r\n */\r\nvar _resizeElement = function (element) {\r\n\tvar codeStyles = getStyles(element);\r\n\tvar whiteSpace = codeStyles['white-space'];\r\n\r\n\tif (whiteSpace === 'pre-wrap' || whiteSpace === 'pre-line') {\r\n\t\tvar codeElement = element.querySelector(Prism.codeTag);\r\n\t\tvar lineNumbersWrapper = element.querySelector('.line-numbers-rows');\r\n\t\tvar lineNumberSizer = element.querySelector('.line-numbers-sizer');\r\n\t\tvar codeLines = codeElement.textContent.split(NEW_LINE_EXP);\r\n\r\n\t\tif (!lineNumberSizer) {\r\n\t\t\tlineNumberSizer = document.createElement('span');\r\n\t\t\tlineNumberSizer.className = 'line-numbers-sizer';\r\n\r\n\t\t\tcodeElement.appendChild(lineNumberSizer);\r\n\t\t}\r\n\r\n\t\tlineNumberSizer.style.display = 'block';\r\n\r\n\t\tcodeLines.forEach(function (line, lineNumber) {\r\n\t\t\tlineNumberSizer.textContent = line || '\\n';\r\n\t\t\tvar lineSize = lineNumberSizer.getBoundingClientRect().height;\r\n\t\t\tlineNumbersWrapper.children[lineNumber].style.height = lineSize + 'px';\r\n\t\t});\r\n\r\n\t\tlineNumberSizer.textContent = '';\r\n\t\tlineNumberSizer.style.display = 'none';\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns style declarations for the element\r\n * @param {Element} element\r\n */\r\nvar getStyles = function (element) {\r\n\tif (!element) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn window.getComputedStyle ? getComputedStyle(element) : (element.currentStyle || null);\r\n};\r\n\r\nPrism.hooks.add('complete', function (env) {\r\n\tif (!env.code) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar code = env.element;\r\n\tvar pre = code.parentNode;\r\n\r\n\t// works only for <code> wrapped inside <pre> (not inline)\r\n\tif (!pre || !/pre/i.test(pre.nodeName)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Abort if line numbers already exists\r\n\tif (code.querySelector('.line-numbers-rows')) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar addLineNumbers = false;\r\n\tvar lineNumbersRegex = /(?:^|\\s)line-numbers(?:\\s|$)/;\r\n\r\n\tfor (var element = code; element; element = element.parentNode) {\r\n\t\tif (lineNumbersRegex.test(element.className)) {\r\n\t\t\taddLineNumbers = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t// only add line numbers if <code> or one of its ancestors has the `line-numbers` class\r\n\tif (!addLineNumbers) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Remove the class 'line-numbers' from the <code>\r\n\tcode.className = code.className.replace(lineNumbersRegex, ' ');\r\n\t// Add the class 'line-numbers' to the <pre>\r\n\tif (!lineNumbersRegex.test(pre.className)) {\r\n\t\tpre.className += ' line-numbers';\r\n\t}\r\n\r\n\tvar match = env.code.match(NEW_LINE_EXP);\r\n\tvar linesNum = match ? match.length + 1 : 1;\r\n\tvar lineNumbersWrapper;\r\n\r\n\tvar lines = new Array(linesNum + 1).join('<span></span>');\r\n\r\n\tlineNumbersWrapper = document.createElement('span');\r\n\tlineNumbersWrapper.setAttribute('aria-hidden', 'true');\r\n\tlineNumbersWrapper.className = 'line-numbers-rows';\r\n\tlineNumbersWrapper.innerHTML = lines;\r\n\r\n\tif (pre.hasAttribute('data-start')) {\r\n\t\tpre.style.counterReset = 'linenumber ' + (parseInt(pre.getAttribute('data-start'), 10) - 1);\r\n\t}\r\n\r\n\tenv.element.appendChild(lineNumbersWrapper);\r\n\r\n\t_resizeElement(pre);\r\n\r\n\tPrism.hooks.run('line-numbers', env);\r\n});\r\n\r\nPrism.hooks.add('line-numbers', function (env) {\r\n\tenv.plugins = env.plugins || {};\r\n\tenv.plugins.lineNumbers = true;\r\n});\r\n\r\n/**\r\n * Global exports\r\n */\r\nPrism.plugins.lineNumbers = {\r\n\t/**\r\n\t * Update line numbers after resizing the text area by mouse\r\n\t * @param {Element} element pre element\r\n\t * @return {undefined}\r\n\t */\r\n\tupdateLineNumbers: function(element) {\r\n\t\t_resizeElement(element);\r\n\t},\r\n\t/**\r\n\t * Get node for provided line number\r\n\t * @param {Element} element pre element\r\n\t * @param {Number} number line number\r\n\t * @return {Element|undefined}\r\n\t */\r\n\tgetLine: function (element, number) {\r\n\t\tif (element.tagName !== 'PRE' || !element.classList.contains(PLUGIN_NAME)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar lineNumberRows = element.querySelector('.line-numbers-rows');\r\n\t\tvar lineNumberStart = parseInt(element.getAttribute('data-start'), 10) || 1;\r\n\t\tvar lineNumberEnd = lineNumberStart + (lineNumberRows.children.length - 1);\r\n\r\n\t\tif (number < lineNumberStart) {\r\n\t\t\tnumber = lineNumberStart;\r\n\t\t}\r\n\t\tif (number > lineNumberEnd) {\r\n\t\t\tnumber = lineNumberEnd;\r\n\t\t}\r\n\r\n\t\tvar lineIndex = number - lineNumberStart;\r\n\r\n\t\treturn lineNumberRows.children[lineIndex];\r\n\t}\r\n};\r\n","import Prism from './prism-core'\r\n\r\nvar MATCH_ALL_CLASS = /(?:^|\\s)match-braces(?:\\s|$)/;\r\n\r\nvar BRACE_HOVER_CLASS = /(?:^|\\s)brace-hover(?:\\s|$)/;\r\nvar BRACE_SELECTED_CLASS = /(?:^|\\s)brace-selected(?:\\s|$)/;\r\n\r\nvar NO_BRACE_HOVER_CLASS = /(?:^|\\s)no-brace-hover(?:\\s|$)/;\r\nvar NO_BRACE_SELECT_CLASS = /(?:^|\\s)no-brace-select(?:\\s|$)/;\r\n\r\nvar PARTNER = {\r\n\t'(': ')',\r\n\t'[': ']',\r\n\t'{': '}',\r\n};\r\n\r\nvar NAMES = {\r\n\t'(': 'brace-round',\r\n\t'[': 'brace-square',\r\n\t'{': 'brace-curly',\r\n};\r\n\r\nvar LEVEL_WARP = 12;\r\n\r\nvar pairIdCounter = 0;\r\n\r\nvar BRACE_ID_PATTERN = /^(pair-\\d+-)(open|close)$/;\r\n\r\n/**\r\n * Returns the brace partner given one brace of a brace pair.\r\n *\r\n * @param {HTMLElement} brace\r\n * @returns {HTMLElement}\r\n */\r\nfunction getPartnerBrace(brace) {\r\n\tvar match = BRACE_ID_PATTERN.exec(brace.id);\r\n\treturn brace.parentElement.querySelector('#' + match[1] + (match[2] == 'open' ? 'close' : 'open'));\r\n}\r\n\r\n/**\r\n * @this {HTMLElement}\r\n */\r\nfunction hoverBrace() {\r\n\tfor (var parent = this.parentElement; parent; parent = parent.parentElement) {\r\n\t\tif (NO_BRACE_HOVER_CLASS.test(parent.className)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\r\n\t\tele.className = (ele.className.replace(BRACE_HOVER_CLASS, ' ') + ' brace-hover').replace(/\\s+/g, ' ');\r\n\t});\r\n}\r\n/**\r\n * @this {HTMLElement}\r\n */\r\nfunction leaveBrace() {\r\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\r\n\t\tele.className = ele.className.replace(BRACE_HOVER_CLASS, ' ');\r\n\t});\r\n}\r\n/**\r\n * @this {HTMLElement}\r\n */\r\nfunction clickBrace() {\r\n\tfor (var parent = this.parentElement; parent; parent = parent.parentElement) {\r\n\t\tif (NO_BRACE_SELECT_CLASS.test(parent.className)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\r\n\t\tele.className = (ele.className.replace(BRACE_SELECTED_CLASS, ' ') + ' brace-selected').replace(/\\s+/g, ' ');\r\n\t});\r\n}\r\n\r\nPrism.hooks.add('complete', function (env) {\r\n\r\n\t/** @type {HTMLElement} */\r\n\tvar code = env.element;\r\n\tvar pre = code.parentElement;\r\n\r\n\tif (!pre || pre.tagName != 'PRE') {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// find the braces to match\r\n\t/** @type {string[]} */\r\n\tvar toMatch = [];\r\n\tfor (var ele = code; ele; ele = ele.parentElement) {\r\n\t\tif (MATCH_ALL_CLASS.test(ele.className)) {\r\n\t\t\ttoMatch.push('(', '[', '{');\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif (toMatch.length == 0) {\r\n\t\t// nothing to match\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!pre.__listenerAdded) {\r\n\t\t// code blocks might be highlighted more than once\r\n\t\tpre.addEventListener('mousedown', function removeBraceSelected() {\r\n\t\t\t// the code element might have been replaced\r\n\t\t\tvar code = pre.querySelector(Prism.codeTag);\r\n\t\t\tArray.prototype.slice.call(code.querySelectorAll('.brace-selected')).forEach(function (element) {\r\n\t\t\t\telement.className = element.className.replace(BRACE_SELECTED_CLASS, ' ');\r\n\t\t\t});\r\n\t\t});\r\n\t\tObject.defineProperty(pre, '__listenerAdded', { value: true });\r\n\t}\r\n\r\n\t/** @type {HTMLSpanElement[]} */\r\n\tvar punctuation = Array.prototype.slice.call(code.querySelectorAll('span.token.punctuation'));\r\n\r\n\t/** @type {{ index: number, open: boolean, element: HTMLElement }[]} */\r\n\tvar allBraces = [];\r\n\r\n\ttoMatch.forEach(function (open) {\r\n\t\tvar close = PARTNER[open];\r\n\t\tvar name = NAMES[open];\r\n\r\n\t\t/** @type {[number, number][]} */\r\n\t\tvar pairs = [];\r\n\t\t/** @type {number[]} */\r\n\t\tvar openStack = [];\r\n\r\n\t\tfor (var i = 0; i < punctuation.length; i++) {\r\n\t\t\tvar element = punctuation[i];\r\n\t\t\tif (element.childElementCount == 0) {\r\n\t\t\t\tvar text = element.textContent;\r\n\t\t\t\tif (text === open) {\r\n\t\t\t\t\tallBraces.push({ index: i, open: true, element: element });\r\n\t\t\t\t\telement.className += ' ' + name;\r\n\t\t\t\t\telement.className += ' brace-open';\r\n\t\t\t\t\topenStack.push(i);\r\n\t\t\t\t} else if (text === close) {\r\n\t\t\t\t\tallBraces.push({ index: i, open: false, element: element });\r\n\t\t\t\t\telement.className += ' ' + name;\r\n\t\t\t\t\telement.className += ' brace-close';\r\n\t\t\t\t\tif (openStack.length) {\r\n\t\t\t\t\t\tpairs.push([i, openStack.pop()]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpairs.forEach(function (pair) {\r\n\t\t\tvar pairId = 'pair-' + (pairIdCounter++) + '-';\r\n\r\n\t\t\tvar openEle = punctuation[pair[0]];\r\n\t\t\tvar closeEle = punctuation[pair[1]];\r\n\r\n\t\t\topenEle.id = pairId + 'open';\r\n\t\t\tcloseEle.id = pairId + 'close';\r\n\r\n\t\t\t[openEle, closeEle].forEach(function (ele) {\r\n\t\t\t\tele.addEventListener('mouseenter', hoverBrace);\r\n\t\t\t\tele.addEventListener('mouseleave', leaveBrace);\r\n\t\t\t\tele.addEventListener('click', clickBrace);\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\r\n\tvar level = 0;\r\n\tallBraces.sort(function (a, b) { return a.index - b.index; });\r\n\tallBraces.forEach(function (brace) {\r\n\t\tif (brace.open) {\r\n\t\t\tbrace.element.className += ' brace-level-' + (level % LEVEL_WARP + 1);\r\n\t\t\tlevel++;\r\n\t\t} else {\r\n\t\t\tlevel = Math.max(0, level - 1);\r\n\t\t\tbrace.element.className += ' brace-level-' + (level % LEVEL_WARP + 1);\r\n\t\t}\r\n\t});\r\n\r\n});\r\n","import Prism from './prism-core'\r\n\r\nPrism.languages.graphviz = {\r\n  comment: [{\r\n    pattern: /\\/\\/(?:[^\\r\\n\\\\]|\\\\(?:\\r\\n?|\\n|(?![\\r\\n])))*|\\/\\*[\\s\\S]*?(?:\\*\\/|$)/,\r\n    greedy: true\r\n  }, {\r\n    pattern: /(^|[^\\\\:])\\/\\/.*/,\r\n    lookbehind: !0,\r\n    greedy: !0\r\n  }],\r\n  string: {\r\n    pattern: /([\"'])(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/,\r\n    greedy: !0\r\n  },\r\n  'class-name': {\r\n    pattern: /(\\b(?:digraph|graph)\\s+)\\w+/,\r\n    lookbehind: true\r\n  },\r\n  keyword: /\\b(?:digraph|graph|node|edge)\\b/,\r\n  property: /\\b(?:Damping|URL|area|arrowhead|arrowsize|arrowtail|aspect|bb|bgcolor|center|charset|clusterrank|color|colorscheme|comment|compound|concentrate|constraint|decorate|defaultdist|dim|dimen|dir|diredgeconstraints|distortion|dpi|edgeURL|edgehref|edgetarget|edgetooltip|epsilon|esep|fillcolor|fixedsize|fontcolor|fontname|fontnames|fontpath|fontsize|group|headURL|headclip|headhref|headlabel|headport|headtarget|headtooltip|height|href|id|image|imagepath|imagescale|label|labelURL|labelangle|labeldistance|labelfloat|labelfontcolor|labelfontname|labelfontsize|labelhref|labeljust|labelloc|labeltarget|labeltooltip|landscape|layer|layerlistsep|layers|layerselect|layersep|layout|len|levels|levelsgap|lhead|lheight|lp|ltail|lwidth|margin|maxiter|mclimit|mindist|minlen|mode|model|mosek|nodesep|nojustify|normalize|nslimit|nslimit1|ordering|orientation|outputorder|overlap|overlap_scaling|pack|packmode|pad|page|pagedir|pencolor|penwidth|peripheries|pin|pos|quadtree|quantum|rank|rankdir|ranksep|ratio|rects|regular|remincross|repulsiveforce|resolution|root|rotate|rotation|samehead|sametail|samplepoints|scale|searchsize|sep|shape|shapefile|showboxes|sides|size|skew|smoothing|sortv|splines|start|style|stylesheet|tail_lp|tailURL|tailclip|tailhref|taillabel|tailport|tailtarget|tailtooltip|target|tooltip|truecolor|vertices|viewport|voro_margin|weight|width|xlabel)\\b/,\r\n  constant: /\\b(?:dot|neato|fdp|sfdp|twopi|circo|osage|patchwork|LR|RL|TB|BT|box|polygon|ellipse|oval|circle|point|egg|triangle|plaintext|plain|diamond|trapezium|parallelogram|house|pentagon|hexagon|septagon|octagon|doublecircle|doubleoctagon|tripleoctagon|invtriangle|invtrapezium|invhouse|Mdiamond|Msquare|Mcircle|rect|rectangle|square|star|none|underline|cylinder|note|tab|folder|box3d|component|promoter|cds|terminator|utr|primersite|restrictionsite|fivepoverhang|threepoverhang|noverhang|assembly|signature|insulator|ribosite|rnastab|proteasesite|proteinstab|rpromoter|rarrow|larrow|lpromoter|solid|dashed|dotted|bold|rounded|diagonals|filled|striped|wedged)\\b/,\r\n  boolean: /\\b(?:true|yes|false|no)\\b/,\r\n  number: /\\b0x[\\da-f]+\\b|(?:\\b\\d+\\.?\\d*|\\B\\.\\d+)(?:e[+-]?\\d+)?/i,\r\n  operator: /->|--|=/,\r\n  punctuation: /[{}[\\];(),.:]/\r\n}\r\n","export function CodeJar(editor, highlight, opt = {}) {\r\n    const options = Object.assign({ tab: \"\\t\", ownerRoot: window }, opt);\r\n    // only Chrome supports shadowRoot.getSelection\r\n    if (typeof options.ownerRoot.getSelection !== 'function') {\r\n        options.ownerRoot = options.ownerRoot.ownerDocument;\r\n        if (typeof options.ownerRoot.getSelection !== 'function') {\r\n            throw new Error('Impossible to access text selections.');\r\n        }\r\n    }\r\n    let listeners = [];\r\n    let history = [];\r\n    let at = -1;\r\n    let focus = false;\r\n    let callback;\r\n    let prev; // code content prior keydown event\r\n    let isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\r\n    editor.setAttribute(\"contentEditable\", isFirefox ? \"true\" : \"plaintext-only\");\r\n    editor.setAttribute(\"spellcheck\", \"false\");\r\n    editor.style.outline = \"none\";\r\n    editor.style.overflowWrap = \"break-word\";\r\n    editor.style.overflowY = \"auto\";\r\n    editor.style.resize = \"vertical\";\r\n    editor.style.whiteSpace = \"pre-wrap\";\r\n    highlight(editor);\r\n    const debounceHighlight = debounce(() => {\r\n        const pos = save();\r\n        highlight(editor);\r\n        restore(pos);\r\n    }, 30);\r\n    let recording = false;\r\n    const shouldRecord = (event) => {\r\n        return !isUndo(event) && !isRedo(event)\r\n            && event.key !== \"Meta\"\r\n            && event.key !== \"Control\"\r\n            && event.key !== \"Alt\"\r\n            && !event.key.startsWith(\"Arrow\");\r\n    };\r\n    const debounceRecordHistory = debounce((event) => {\r\n        if (shouldRecord(event)) {\r\n            recordHistory();\r\n            recording = false;\r\n        }\r\n    }, 300);\r\n    const on = (type, fn) => {\r\n        listeners.push([type, fn]);\r\n        editor.addEventListener(type, fn);\r\n    };\r\n    on(\"keydown\", event => {\r\n        if (event.defaultPrevented)\r\n            return;\r\n        prev = toString();\r\n        handleNewLine(event);\r\n        handleTabCharacters(event);\r\n        handleJumpToBeginningOfLine(event);\r\n        handleSelfClosingCharacters(event);\r\n        handleUndoRedo(event);\r\n        if (shouldRecord(event) && !recording) {\r\n            recordHistory();\r\n            recording = true;\r\n        }\r\n    });\r\n    on(\"keyup\", event => {\r\n        if (event.defaultPrevented)\r\n            return;\r\n        if (event.isComposing)\r\n            return;\r\n        if (prev !== toString())\r\n            debounceHighlight();\r\n        debounceRecordHistory(event);\r\n        if (callback)\r\n            callback(toString());\r\n    });\r\n    on(\"focus\", _event => {\r\n        focus = true;\r\n    });\r\n    on(\"blur\", _event => {\r\n        focus = false;\r\n    });\r\n    on(\"paste\", event => {\r\n        recordHistory();\r\n        handlePaste(event);\r\n        recordHistory();\r\n        if (callback)\r\n            callback(toString());\r\n    });\r\n    function save() {\r\n        const s = options.ownerRoot.getSelection();\r\n        const pos = { start: 0, end: 0, dir: undefined };\r\n        visit(editor, el => {\r\n            if (el === s.anchorNode && el === s.focusNode) {\r\n                pos.start += s.anchorOffset;\r\n                pos.end += s.focusOffset;\r\n                pos.dir = s.anchorOffset <= s.focusOffset ? \"->\" : \"<-\";\r\n                return \"stop\";\r\n            }\r\n            if (el === s.anchorNode) {\r\n                pos.start += s.anchorOffset;\r\n                if (!pos.dir) {\r\n                    pos.dir = \"->\";\r\n                }\r\n                else {\r\n                    return \"stop\";\r\n                }\r\n            }\r\n            else if (el === s.focusNode) {\r\n                pos.end += s.focusOffset;\r\n                if (!pos.dir) {\r\n                    pos.dir = \"<-\";\r\n                }\r\n                else {\r\n                    return \"stop\";\r\n                }\r\n            }\r\n            if (el.nodeType === Node.TEXT_NODE) {\r\n                if (pos.dir != \"->\")\r\n                    pos.start += el.nodeValue.length;\r\n                if (pos.dir != \"<-\")\r\n                    pos.end += el.nodeValue.length;\r\n            }\r\n        });\r\n        return pos;\r\n    }\r\n    function restore(pos) {\r\n        const s = options.ownerRoot.getSelection();\r\n        let startNode, startOffset = 0;\r\n        let endNode, endOffset = 0;\r\n        if (!pos.dir)\r\n            pos.dir = \"->\";\r\n        if (pos.start < 0)\r\n            pos.start = 0;\r\n        if (pos.end < 0)\r\n            pos.end = 0;\r\n        // Flip start and end if the direction reversed\r\n        if (pos.dir == \"<-\") {\r\n            const { start, end } = pos;\r\n            pos.start = end;\r\n            pos.end = start;\r\n        }\r\n        let current = 0;\r\n        visit(editor, el => {\r\n            if (el.nodeType !== Node.TEXT_NODE)\r\n                return;\r\n            const len = (el.nodeValue || \"\").length;\r\n            if (current + len >= pos.start) {\r\n                if (!startNode) {\r\n                    startNode = el;\r\n                    startOffset = pos.start - current;\r\n                }\r\n                if (current + len >= pos.end) {\r\n                    endNode = el;\r\n                    endOffset = pos.end - current;\r\n                    return \"stop\";\r\n                }\r\n            }\r\n            current += len;\r\n        });\r\n        // If everything deleted place cursor at editor\r\n        if (!startNode)\r\n            startNode = editor;\r\n        if (!endNode)\r\n            endNode = editor;\r\n        // Flip back the selection\r\n        if (pos.dir == \"<-\") {\r\n            [startNode, startOffset, endNode, endOffset] = [endNode, endOffset, startNode, startOffset];\r\n        }\r\n        s.setBaseAndExtent(startNode, startOffset, endNode, endOffset);\r\n    }\r\n    function beforeCursor() {\r\n        const s = options.ownerRoot.getSelection();\r\n        const r0 = s.getRangeAt(0);\r\n        const r = document.createRange();\r\n        r.selectNodeContents(editor);\r\n        r.setEnd(r0.startContainer, r0.startOffset);\r\n        return r.toString();\r\n    }\r\n    function afterCursor() {\r\n        const s = options.ownerRoot.getSelection();\r\n        const r0 = s.getRangeAt(0);\r\n        const r = document.createRange();\r\n        r.selectNodeContents(editor);\r\n        r.setStart(r0.endContainer, r0.endOffset);\r\n        return r.toString();\r\n    }\r\n    function handleNewLine(event) {\r\n        if (event.key === \"Enter\") {\r\n            const before = beforeCursor();\r\n            const after = afterCursor();\r\n            let [padding] = findPadding(before);\r\n            let newLinePadding = padding;\r\n            // If last symbol is \"{\" ident new line\r\n            if (before[before.length - 1] === \"{\") {\r\n                newLinePadding += options.tab;\r\n            }\r\n            if (isFirefox) {\r\n                preventDefault(event);\r\n                insert(\"\\n\" + newLinePadding);\r\n            }\r\n            else {\r\n                // Normal browsers\r\n                if (newLinePadding.length > 0) {\r\n                    preventDefault(event);\r\n                    insert(\"\\n\" + newLinePadding);\r\n                }\r\n            }\r\n            // Place adjacent \"}\" on next line\r\n            if (newLinePadding !== padding && after[0] === \"}\") {\r\n                const pos = save();\r\n                insert(\"\\n\" + padding);\r\n                restore(pos);\r\n            }\r\n        }\r\n    }\r\n    function handleSelfClosingCharacters(event) {\r\n        const open = `([{'\"`;\r\n        const close = `)]}'\"`;\r\n        const codeAfter = afterCursor();\r\n        if (close.includes(event.key) && codeAfter.substr(0, 1) === event.key) {\r\n            const pos = save();\r\n            preventDefault(event);\r\n            pos.start = ++pos.end;\r\n            restore(pos);\r\n        }\r\n        else if (open.includes(event.key)) {\r\n            const pos = save();\r\n            preventDefault(event);\r\n            const text = event.key + close[open.indexOf(event.key)];\r\n            insert(text);\r\n            pos.start = ++pos.end;\r\n            restore(pos);\r\n        }\r\n    }\r\n    function handleTabCharacters(event) {\r\n        if (event.key === \"Tab\") {\r\n            preventDefault(event);\r\n            if (event.shiftKey) {\r\n                const before = beforeCursor();\r\n                let [padding, start,] = findPadding(before);\r\n                if (padding.length > 0) {\r\n                    const pos = save();\r\n                    // Remove full length tab or just remaining padding\r\n                    const len = Math.min(options.tab.length, padding.length);\r\n                    restore({ start, end: start + len });\r\n                    document.execCommand(\"delete\");\r\n                    pos.start -= len;\r\n                    pos.end -= len;\r\n                    restore(pos);\r\n                }\r\n            }\r\n            else {\r\n                insert(options.tab);\r\n            }\r\n        }\r\n    }\r\n    function handleJumpToBeginningOfLine(event) {\r\n        if (event.key === \"ArrowLeft\" && event.metaKey) {\r\n            preventDefault(event);\r\n            const before = beforeCursor();\r\n            let [padding, start, end] = findPadding(before);\r\n            if (before.endsWith(padding)) {\r\n                if (event.shiftKey) {\r\n                    const pos = save();\r\n                    restore({ start, end: pos.end }); // Select from line start.\r\n                }\r\n                else {\r\n                    restore({ start, end: start }); // Jump to line start.\r\n                }\r\n            }\r\n            else {\r\n                if (event.shiftKey) {\r\n                    const pos = save();\r\n                    restore({ start: end, end: pos.end }); // Select from beginning of text.\r\n                }\r\n                else {\r\n                    restore({ start: end, end }); // Jump to beginning of text.\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function handleUndoRedo(event) {\r\n        if (isUndo(event)) {\r\n            preventDefault(event);\r\n            at--;\r\n            const record = history[at];\r\n            if (record) {\r\n                editor.innerHTML = record.html;\r\n                restore(record.pos);\r\n            }\r\n            if (at < 0)\r\n                at = 0;\r\n        }\r\n        if (isRedo(event)) {\r\n            preventDefault(event);\r\n            at++;\r\n            const record = history[at];\r\n            if (record) {\r\n                editor.innerHTML = record.html;\r\n                restore(record.pos);\r\n            }\r\n            if (at >= history.length)\r\n                at--;\r\n        }\r\n    }\r\n    function recordHistory() {\r\n        if (!focus)\r\n            return;\r\n        const html = editor.innerHTML;\r\n        const pos = save();\r\n        const lastRecord = history[at];\r\n        if (lastRecord) {\r\n            if (lastRecord.html === html\r\n                && lastRecord.pos.start === pos.start\r\n                && lastRecord.pos.end === pos.end)\r\n                return;\r\n        }\r\n        at++;\r\n        history[at] = { html, pos };\r\n        history.splice(at + 1);\r\n        const maxHistory = 300;\r\n        if (at > maxHistory) {\r\n            at = maxHistory;\r\n            history.splice(0, 1);\r\n        }\r\n    }\r\n    function handlePaste(event) {\r\n        preventDefault(event);\r\n        const text = (event.originalEvent || event).clipboardData.getData(\"text/plain\");\r\n        const pos = save();\r\n        insert(text);\r\n        highlight(editor);\r\n        restore({ start: pos.end + text.length, end: pos.end + text.length });\r\n    }\r\n    function visit(editor, visitor) {\r\n        const queue = [];\r\n        if (editor.firstChild)\r\n            queue.push(editor.firstChild);\r\n        let el = queue.pop();\r\n        while (el) {\r\n            if (visitor(el) === \"stop\")\r\n                break;\r\n            if (el.nextSibling)\r\n                queue.push(el.nextSibling);\r\n            if (el.firstChild)\r\n                queue.push(el.firstChild);\r\n            el = queue.pop();\r\n        }\r\n    }\r\n    function isCtrl(event) {\r\n        return event.metaKey || event.ctrlKey;\r\n    }\r\n    function isUndo(event) {\r\n        return isCtrl(event) && !event.shiftKey && event.code === \"KeyZ\";\r\n    }\r\n    function isRedo(event) {\r\n        return isCtrl(event) && event.shiftKey && event.code === \"KeyZ\";\r\n    }\r\n    function insert(text) {\r\n        text = text\r\n            .replace(/&/g, \"&amp;\")\r\n            .replace(/</g, \"&lt;\")\r\n            .replace(/>/g, \"&gt;\")\r\n            .replace(/\"/g, \"&quot;\")\r\n            .replace(/'/g, \"&#039;\");\r\n        document.execCommand(\"insertHTML\", false, text);\r\n    }\r\n    function debounce(cb, wait) {\r\n        let timeout = 0;\r\n        return (...args) => {\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(() => cb(...args), wait);\r\n        };\r\n    }\r\n    function findPadding(text) {\r\n        // Find beginning of previous line.\r\n        let i = text.length - 1;\r\n        while (i >= 0 && text[i] !== \"\\n\")\r\n            i--;\r\n        i++;\r\n        // Find padding of the line.\r\n        let j = i;\r\n        while (j < text.length && /[ \\t]/.test(text[j]))\r\n            j++;\r\n        return [text.substring(i, j) || \"\", i, j];\r\n    }\r\n    function toString() {\r\n        return editor.textContent || \"\";\r\n    }\r\n    function preventDefault(event) {\r\n        event.preventDefault();\r\n    }\r\n    return {\r\n        updateOptions(options) {\r\n            options = Object.assign(Object.assign({}, options), options);\r\n        },\r\n        updateCode(code) {\r\n            editor.textContent = code;\r\n            highlight(editor);\r\n        },\r\n        onUpdate(cb) {\r\n            callback = cb;\r\n        },\r\n        toString,\r\n        destroy() {\r\n            for (let [type, fn] of listeners) {\r\n                editor.removeEventListener(type, fn);\r\n            }\r\n        },\r\n    };\r\n}\r\n"],"names":["template","pendingAllLineNumbersUpdate","_","lang","uniqueId","Prism","codeTag","util","encode","tokens","Token","type","content","alias","Array","isArray","map","replace","o","Object","prototype","toString","call","slice","objId","obj","defineProperty","value","clone","deepClone","visited","id","key","hasOwnProperty","forEach","v","i","getLanguage","element","test","className","parentElement","match","toLowerCase","languages","extend","redef","insertBefore","inside","before","insert","root","grammar","ret","token","newToken","old","DFS","callback","property","propertyType","plugins","highlightElement","language","parent","parentNode","nodeName","code","textContent","env","insertHighlightedCode","highlightedCode","hooks","run","innerHTML","highlight","text","tokenize","stringify","rest","tokenList","LinkedList","addAfter","head","matchGrammar","startNode","startPos","oneshot","target","patterns","j","length","pattern","lookbehind","greedy","lookbehindLength","global","flags","RegExp","source","currentNode","next","pos","tail","str","removeCount","prev","lastIndex","exec","from","index","to","p","k","after","removeFrom","removeRange","list","node","count","wrapped","toArray","array","push","all","add","name","callbacks","matchedStr","newNode","s","e","tag","classes","attributes","aliases","apply","join","NEW_LINE_EXP","_resizeElement","whiteSpace","codeStyles","getStyles","codeElement","querySelector","lineNumbersWrapper","lineNumberSizer","codeLines","split","document","createElement","appendChild","style","display","line","lineNumber","lineSize","getBoundingClientRect","height","children","window","getComputedStyle","currentStyle","pre","addLineNumbers","lineNumbersRegex","lines","linesNum","setAttribute","hasAttribute","counterReset","parseInt","getAttribute","lineNumbers","updateLineNumbers","getLine","number","tagName","classList","contains","lineNumberRows","lineNumberStart","lineNumberEnd","lineIndex","MATCH_ALL_CLASS","BRACE_HOVER_CLASS","BRACE_SELECTED_CLASS","NO_BRACE_HOVER_CLASS","NO_BRACE_SELECT_CLASS","PARTNER","NAMES","pairIdCounter","BRACE_ID_PATTERN","getPartnerBrace","brace","hoverBrace","ele","leaveBrace","clickBrace","toMatch","__listenerAdded","addEventListener","querySelectorAll","punctuation","allBraces","open","close","pairs","openStack","childElementCount","pop","pair","pairId","openEle","closeEle","level","sort","a","b","Math","max","graphviz","comment","string","keyword","constant","boolean","operator","features","connectedKey","Symbol","valueKey","tabKey","classKey","jarKey","widthKey","heightKey","mousedownKey","mouseupKey","normalizeLineBreaks","createEditor","ownerRoot","shadowRoot","getElementById","featureClasses","trim","filter","feature","includes","jar","CodeJar","editor","opt","options","assign","tab","getSelection","ownerDocument","Error","listeners","history","at","focus","isFirefox","navigator","userAgent","indexOf","outline","overflowWrap","overflowY","resize","debounceHighlight","debounce","save","restore","recording","shouldRecord","event","isUndo","isRedo","startsWith","debounceRecordHistory","recordHistory","on","fn","start","end","dir","undefined","visit","el","anchorNode","focusNode","anchorOffset","focusOffset","nodeType","Node","TEXT_NODE","nodeValue","startOffset","endNode","endOffset","current","len","setBaseAndExtent","beforeCursor","r0","getRangeAt","r","createRange","selectNodeContents","setEnd","startContainer","afterCursor","setStart","endContainer","html","lastRecord","splice","visitor","queue","firstChild","nextSibling","isCtrl","metaKey","ctrlKey","shiftKey","execCommand","cb","wait","timeout","args","clearTimeout","setTimeout","findPadding","substring","preventDefault","defaultPrevented","handleNewLine","padding","newLinePadding","handleTabCharacters","min","handleJumpToBeginningOfLine","endsWith","handleSelfClosingCharacters","codeAfter","substr","handleUndoRedo","record","isComposing","_event","handlePaste","originalEvent","clipboardData","getData","updateOptions","updateCode","onUpdate","destroy","removeEventListener","updateEditor","newCode","triggerEvent","detail","dispatchEvent","CustomEvent","destroyEditor","GraphvizScriptEditorElement","HTMLElement","constructor","attachShadow","mode","getTemplate","cloneNode","attributeChangedCallback","oldValue","newValue","configureEditor","hasChangedFeatureClass","oldClasses","newClasses","some","connectedCallback","registerEvents","mousedown","clientWidth","clientHeight","mouseup","disconnectedCallback","observedAttributes","newWidth","newHeight","updateAllLineNumbers","editors","customElements","define"],"mappings":"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"}