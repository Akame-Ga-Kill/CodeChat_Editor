{"version":3,"file":"script-editor.min.mjs","sources":["../src/codejar/codejar.js","../src/script-editor.js","../src/prism/prism-core.js","../src/prism/prism-line-numbers.js","../src/prism/prism-match-braces.js","../src/prism/prism-graphviz.js"],"sourcesContent":["export function CodeJar(editor, highlight, opt = {}) {\r\n    const options = Object.assign({ tab: \"\\t\", ownerRoot: window }, opt);\r\n    // only Chrome supports shadowRoot.getSelection\r\n    if (typeof options.ownerRoot.getSelection !== 'function') {\r\n        options.ownerRoot = options.ownerRoot.ownerDocument;\r\n        if (typeof options.ownerRoot.getSelection !== 'function') {\r\n            throw new Error('Impossible to access text selections.');\r\n        }\r\n    }\r\n    let listeners = [];\r\n    let history = [];\r\n    let at = -1;\r\n    let focus = false;\r\n    let callback;\r\n    let prev; // code content prior keydown event\r\n    let isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\r\n    editor.setAttribute(\"contentEditable\", isFirefox ? \"true\" : \"plaintext-only\");\r\n    editor.setAttribute(\"spellcheck\", \"false\");\r\n    editor.style.outline = \"none\";\r\n    editor.style.overflowWrap = \"break-word\";\r\n    editor.style.overflowY = \"auto\";\r\n    editor.style.resize = \"vertical\";\r\n    editor.style.whiteSpace = \"pre-wrap\";\r\n    highlight(editor);\r\n    const debounceHighlight = debounce(() => {\r\n        const pos = save();\r\n        highlight(editor);\r\n        restore(pos);\r\n    }, 30);\r\n    let recording = false;\r\n    const shouldRecord = (event) => {\r\n        return !isUndo(event) && !isRedo(event)\r\n            && event.key !== \"Meta\"\r\n            && event.key !== \"Control\"\r\n            && event.key !== \"Alt\"\r\n            && !event.key.startsWith(\"Arrow\");\r\n    };\r\n    const debounceRecordHistory = debounce((event) => {\r\n        if (shouldRecord(event)) {\r\n            recordHistory();\r\n            recording = false;\r\n        }\r\n    }, 300);\r\n    const on = (type, fn) => {\r\n        listeners.push([type, fn]);\r\n        editor.addEventListener(type, fn);\r\n    };\r\n    on(\"keydown\", event => {\r\n        if (event.defaultPrevented)\r\n            return;\r\n        prev = toString();\r\n        handleNewLine(event);\r\n        handleTabCharacters(event);\r\n        handleJumpToBeginningOfLine(event);\r\n        handleSelfClosingCharacters(event);\r\n        handleUndoRedo(event);\r\n        if (shouldRecord(event) && !recording) {\r\n            recordHistory();\r\n            recording = true;\r\n        }\r\n    });\r\n    on(\"keyup\", event => {\r\n        if (event.defaultPrevented)\r\n            return;\r\n        if (event.isComposing)\r\n            return;\r\n        if (prev !== toString())\r\n            debounceHighlight();\r\n        debounceRecordHistory(event);\r\n        if (callback)\r\n            callback(toString());\r\n    });\r\n    on(\"focus\", _event => {\r\n        focus = true;\r\n    });\r\n    on(\"blur\", _event => {\r\n        focus = false;\r\n    });\r\n    on(\"paste\", event => {\r\n        recordHistory();\r\n        handlePaste(event);\r\n        recordHistory();\r\n        if (callback)\r\n            callback(toString());\r\n    });\r\n    function save() {\r\n        const s = options.ownerRoot.getSelection();\r\n        const pos = { start: 0, end: 0, dir: undefined };\r\n        visit(editor, el => {\r\n            if (el === s.anchorNode && el === s.focusNode) {\r\n                pos.start += s.anchorOffset;\r\n                pos.end += s.focusOffset;\r\n                pos.dir = s.anchorOffset <= s.focusOffset ? \"->\" : \"<-\";\r\n                return \"stop\";\r\n            }\r\n            if (el === s.anchorNode) {\r\n                pos.start += s.anchorOffset;\r\n                if (!pos.dir) {\r\n                    pos.dir = \"->\";\r\n                }\r\n                else {\r\n                    return \"stop\";\r\n                }\r\n            }\r\n            else if (el === s.focusNode) {\r\n                pos.end += s.focusOffset;\r\n                if (!pos.dir) {\r\n                    pos.dir = \"<-\";\r\n                }\r\n                else {\r\n                    return \"stop\";\r\n                }\r\n            }\r\n            if (el.nodeType === Node.TEXT_NODE) {\r\n                if (pos.dir != \"->\")\r\n                    pos.start += el.nodeValue.length;\r\n                if (pos.dir != \"<-\")\r\n                    pos.end += el.nodeValue.length;\r\n            }\r\n        });\r\n        return pos;\r\n    }\r\n    function restore(pos) {\r\n        const s = options.ownerRoot.getSelection();\r\n        let startNode, startOffset = 0;\r\n        let endNode, endOffset = 0;\r\n        if (!pos.dir)\r\n            pos.dir = \"->\";\r\n        if (pos.start < 0)\r\n            pos.start = 0;\r\n        if (pos.end < 0)\r\n            pos.end = 0;\r\n        // Flip start and end if the direction reversed\r\n        if (pos.dir == \"<-\") {\r\n            const { start, end } = pos;\r\n            pos.start = end;\r\n            pos.end = start;\r\n        }\r\n        let current = 0;\r\n        visit(editor, el => {\r\n            if (el.nodeType !== Node.TEXT_NODE)\r\n                return;\r\n            const len = (el.nodeValue || \"\").length;\r\n            if (current + len >= pos.start) {\r\n                if (!startNode) {\r\n                    startNode = el;\r\n                    startOffset = pos.start - current;\r\n                }\r\n                if (current + len >= pos.end) {\r\n                    endNode = el;\r\n                    endOffset = pos.end - current;\r\n                    return \"stop\";\r\n                }\r\n            }\r\n            current += len;\r\n        });\r\n        // If everything deleted place cursor at editor\r\n        if (!startNode)\r\n            startNode = editor;\r\n        if (!endNode)\r\n            endNode = editor;\r\n        // Flip back the selection\r\n        if (pos.dir == \"<-\") {\r\n            [startNode, startOffset, endNode, endOffset] = [endNode, endOffset, startNode, startOffset];\r\n        }\r\n        s.setBaseAndExtent(startNode, startOffset, endNode, endOffset);\r\n    }\r\n    function beforeCursor() {\r\n        const s = options.ownerRoot.getSelection();\r\n        const r0 = s.getRangeAt(0);\r\n        const r = document.createRange();\r\n        r.selectNodeContents(editor);\r\n        r.setEnd(r0.startContainer, r0.startOffset);\r\n        return r.toString();\r\n    }\r\n    function afterCursor() {\r\n        const s = options.ownerRoot.getSelection();\r\n        const r0 = s.getRangeAt(0);\r\n        const r = document.createRange();\r\n        r.selectNodeContents(editor);\r\n        r.setStart(r0.endContainer, r0.endOffset);\r\n        return r.toString();\r\n    }\r\n    function handleNewLine(event) {\r\n        if (event.key === \"Enter\") {\r\n            const before = beforeCursor();\r\n            const after = afterCursor();\r\n            let [padding] = findPadding(before);\r\n            let newLinePadding = padding;\r\n            // If last symbol is \"{\" ident new line\r\n            if (before[before.length - 1] === \"{\") {\r\n                newLinePadding += options.tab;\r\n            }\r\n            if (isFirefox) {\r\n                preventDefault(event);\r\n                insert(\"\\n\" + newLinePadding);\r\n            }\r\n            else {\r\n                // Normal browsers\r\n                if (newLinePadding.length > 0) {\r\n                    preventDefault(event);\r\n                    insert(\"\\n\" + newLinePadding);\r\n                }\r\n            }\r\n            // Place adjacent \"}\" on next line\r\n            if (newLinePadding !== padding && after[0] === \"}\") {\r\n                const pos = save();\r\n                insert(\"\\n\" + padding);\r\n                restore(pos);\r\n            }\r\n        }\r\n    }\r\n    function handleSelfClosingCharacters(event) {\r\n        const open = `([{'\"`;\r\n        const close = `)]}'\"`;\r\n        const codeAfter = afterCursor();\r\n        if (close.includes(event.key) && codeAfter.substr(0, 1) === event.key) {\r\n            const pos = save();\r\n            preventDefault(event);\r\n            pos.start = ++pos.end;\r\n            restore(pos);\r\n        }\r\n        else if (open.includes(event.key)) {\r\n            const pos = save();\r\n            preventDefault(event);\r\n            const text = event.key + close[open.indexOf(event.key)];\r\n            insert(text);\r\n            pos.start = ++pos.end;\r\n            restore(pos);\r\n        }\r\n    }\r\n    function handleTabCharacters(event) {\r\n        if (event.key === \"Tab\") {\r\n            preventDefault(event);\r\n            if (event.shiftKey) {\r\n                const before = beforeCursor();\r\n                let [padding, start,] = findPadding(before);\r\n                if (padding.length > 0) {\r\n                    const pos = save();\r\n                    // Remove full length tab or just remaining padding\r\n                    const len = Math.min(options.tab.length, padding.length);\r\n                    restore({ start, end: start + len });\r\n                    document.execCommand(\"delete\");\r\n                    pos.start -= len;\r\n                    pos.end -= len;\r\n                    restore(pos);\r\n                }\r\n            }\r\n            else {\r\n                insert(options.tab);\r\n            }\r\n        }\r\n    }\r\n    function handleJumpToBeginningOfLine(event) {\r\n        if (event.key === \"ArrowLeft\" && event.metaKey) {\r\n            preventDefault(event);\r\n            const before = beforeCursor();\r\n            let [padding, start, end] = findPadding(before);\r\n            if (before.endsWith(padding)) {\r\n                if (event.shiftKey) {\r\n                    const pos = save();\r\n                    restore({ start, end: pos.end }); // Select from line start.\r\n                }\r\n                else {\r\n                    restore({ start, end: start }); // Jump to line start.\r\n                }\r\n            }\r\n            else {\r\n                if (event.shiftKey) {\r\n                    const pos = save();\r\n                    restore({ start: end, end: pos.end }); // Select from beginning of text.\r\n                }\r\n                else {\r\n                    restore({ start: end, end }); // Jump to beginning of text.\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function handleUndoRedo(event) {\r\n        if (isUndo(event)) {\r\n            preventDefault(event);\r\n            at--;\r\n            const record = history[at];\r\n            if (record) {\r\n                editor.innerHTML = record.html;\r\n                restore(record.pos);\r\n            }\r\n            if (at < 0)\r\n                at = 0;\r\n        }\r\n        if (isRedo(event)) {\r\n            preventDefault(event);\r\n            at++;\r\n            const record = history[at];\r\n            if (record) {\r\n                editor.innerHTML = record.html;\r\n                restore(record.pos);\r\n            }\r\n            if (at >= history.length)\r\n                at--;\r\n        }\r\n    }\r\n    function recordHistory() {\r\n        if (!focus)\r\n            return;\r\n        const html = editor.innerHTML;\r\n        const pos = save();\r\n        const lastRecord = history[at];\r\n        if (lastRecord) {\r\n            if (lastRecord.html === html\r\n                && lastRecord.pos.start === pos.start\r\n                && lastRecord.pos.end === pos.end)\r\n                return;\r\n        }\r\n        at++;\r\n        history[at] = { html, pos };\r\n        history.splice(at + 1);\r\n        const maxHistory = 300;\r\n        if (at > maxHistory) {\r\n            at = maxHistory;\r\n            history.splice(0, 1);\r\n        }\r\n    }\r\n    function handlePaste(event) {\r\n        preventDefault(event);\r\n        const text = (event.originalEvent || event).clipboardData.getData(\"text/plain\");\r\n        const pos = save();\r\n        insert(text);\r\n        highlight(editor);\r\n        restore({ start: pos.end + text.length, end: pos.end + text.length });\r\n    }\r\n    function visit(editor, visitor) {\r\n        const queue = [];\r\n        if (editor.firstChild)\r\n            queue.push(editor.firstChild);\r\n        let el = queue.pop();\r\n        while (el) {\r\n            if (visitor(el) === \"stop\")\r\n                break;\r\n            if (el.nextSibling)\r\n                queue.push(el.nextSibling);\r\n            if (el.firstChild)\r\n                queue.push(el.firstChild);\r\n            el = queue.pop();\r\n        }\r\n    }\r\n    function isCtrl(event) {\r\n        return event.metaKey || event.ctrlKey;\r\n    }\r\n    function isUndo(event) {\r\n        return isCtrl(event) && !event.shiftKey && event.code === \"KeyZ\";\r\n    }\r\n    function isRedo(event) {\r\n        return isCtrl(event) && event.shiftKey && event.code === \"KeyZ\";\r\n    }\r\n    function insert(text) {\r\n        text = text\r\n            .replace(/&/g, \"&amp;\")\r\n            .replace(/</g, \"&lt;\")\r\n            .replace(/>/g, \"&gt;\")\r\n            .replace(/\"/g, \"&quot;\")\r\n            .replace(/'/g, \"&#039;\");\r\n        document.execCommand(\"insertHTML\", false, text);\r\n    }\r\n    function debounce(cb, wait) {\r\n        let timeout = 0;\r\n        return (...args) => {\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(() => cb(...args), wait);\r\n        };\r\n    }\r\n    function findPadding(text) {\r\n        // Find beginning of previous line.\r\n        let i = text.length - 1;\r\n        while (i >= 0 && text[i] !== \"\\n\")\r\n            i--;\r\n        i++;\r\n        // Find padding of the line.\r\n        let j = i;\r\n        while (j < text.length && /[ \\t]/.test(text[j]))\r\n            j++;\r\n        return [text.substring(i, j) || \"\", i, j];\r\n    }\r\n    function toString() {\r\n        return editor.textContent || \"\";\r\n    }\r\n    function preventDefault(event) {\r\n        event.preventDefault();\r\n    }\r\n    return {\r\n        updateOptions(options) {\r\n            options = Object.assign(Object.assign({}, options), options);\r\n        },\r\n        updateCode(code) {\r\n            editor.textContent = code;\r\n            highlight(editor);\r\n        },\r\n        onUpdate(cb) {\r\n            callback = cb;\r\n        },\r\n        toString,\r\n        destroy() {\r\n            for (let [type, fn] of listeners) {\r\n                editor.removeEventListener(type, fn);\r\n            }\r\n        },\r\n    };\r\n}\r\n","import { CodeJar } from './codejar/codejar'\r\nimport Prism from './prism/prism-core'\r\nimport lightTheme from './prism/prism-light.css'\r\nimport lineNumbersStyle from './prism/prism-line-numbers.css'\r\nimport matchBracesStyle from './prism/prism-match-braces.css'\r\nimport mainStyle from './script-editor.css'\r\nimport './prism/prism-line-numbers'\r\nimport './prism/prism-match-braces'\r\nimport './prism/prism-graphviz'\r\n\r\nconst features = ['line-numbers', 'match-braces', 'rainbow-braces']\r\nconst connectedKey = Symbol('connecte')\r\nconst valueKey = Symbol('value')\r\nconst tabKey = Symbol('tab')\r\nconst classKey = Symbol('class')\r\nconst jarKey = Symbol('jar')\r\nconst widthKey = Symbol('width')\r\nconst heightKey = Symbol('height')\r\nconst mousedownKey = Symbol('mousedown')\r\nconst mouseupKey = Symbol('mouseup')\r\nlet template, pendingAllLineNumbersUpdate\r\n\r\nPrism.codeTag = 'div'\r\n\r\nfunction getTemplate () {\r\n  if (!template) {\r\n    template = document.createElement('template')\r\n    template.innerHTML = `<style>\r\n${lightTheme}\r\n${lineNumbersStyle}\r\n${matchBracesStyle}\r\n${mainStyle}\r\n</style>\r\n<pre id=source-wrapper><div id=source></div></pre>`\r\n  }\r\n  return template\r\n}\r\n\r\nfunction triggerEvent (element, type, detail) {\r\n  element.dispatchEvent(new CustomEvent(type, { detail }))\r\n}\r\n\r\nfunction getFeatureClasses (element) {\r\n  return element.className\r\n    .trim()\r\n    .split(/\\s+/)\r\n    .filter(feature => features.includes(feature))\r\n    .join(' ')\r\n}\r\n\r\nfunction hasChangedFeatureClass (oldValue, newValue) {\r\n  const oldClasses = oldValue ? oldValue.trim().split(/\\s+/) : []\r\n  const newClasses = newValue.trim().split(/\\s+/)\r\n  return features.some(feature =>\r\n    oldClasses.includes(feature) !== newClasses.includes(feature))\r\n}\r\n\r\nfunction normalizeLineBreaks (value) {\r\n  return value.replace(/\\r?\\n/, '\\n')\r\n}\r\n\r\nfunction createEditor (element) {\r\n  const ownerRoot = element.shadowRoot\r\n  const source = ownerRoot.getElementById('source')\r\n  const featureClasses = getFeatureClasses(element)\r\n  source.className = `language-graphviz ${featureClasses}`\r\n  const jar = element[jarKey] = CodeJar(source, Prism.highlightElement, { tab: element.tab, ownerRoot })\r\n  updateEditor(element)\r\n  jar.onUpdate(newCode => {\r\n    newCode = normalizeLineBreaks(newCode)\r\n    if (element.value !== newCode) {\r\n      element[valueKey] = newCode\r\n      triggerEvent(element, 'input', newCode)\r\n    }\r\n  })\r\n}\r\n\r\nfunction destroyEditor (element) {\r\n  element[jarKey].destroy()\r\n  element[jarKey] = null\r\n}\r\n\r\nfunction rebuildEditor (element) {\r\n  destroyEditor(element)\r\n  createEditor(element)\r\n}\r\n\r\nfunction updateEditor (element) {\r\n  element[jarKey].updateCode(element.value)\r\n}\r\n\r\nfunction configureEditor (element) {\r\n  element[jarKey].updateOptions({ tab: element.tab })\r\n}\r\n\r\nclass GraphvizScriptEditorElement extends HTMLElement {\r\n  constructor () {\r\n    super()\r\n    this[valueKey] = ''\r\n    this[tabKey] = '  '\r\n    this[classKey] = ''\r\n    this.attachShadow({ mode: 'open' })\r\n    this.shadowRoot.appendChild(getTemplate().content.cloneNode(true))\r\n  }\r\n\r\n  get value () { return this[valueKey] }\r\n  set value (value) { this.setAttribute('value', value) }\r\n\r\n  get tab () { return this[tabKey] }\r\n  set tab (value) { this.setAttribute('tab', value) }\r\n\r\n  get className () { return this[classKey] }\r\n  set className (value) { this.setAttribute('class', value) }\r\n\r\n  attributeChangedCallback (name, oldValue, newValue) {\r\n    switch (name) {\r\n      case 'value':\r\n        this[valueKey] = normalizeLineBreaks(newValue)\r\n        if (this[connectedKey]) updateEditor(this)\r\n        break\r\n      case 'tab':\r\n        this[tabKey] = newValue\r\n        if (this[connectedKey]) configureEditor(this)\r\n        break\r\n      case 'class':\r\n        this[classKey] = newValue\r\n        if (this[connectedKey] && hasChangedFeatureClass(oldValue, newValue)) rebuildEditor(this)\r\n        break\r\n    }\r\n  }\r\n\r\n  connectedCallback () {\r\n    registerEvents(this)\r\n    createEditor(this)\r\n    this[connectedKey] = true\r\n  }\r\n\r\n  disconnectedCallback () {\r\n    destroyEditor(this)\r\n    unregisterEvents(this)\r\n    this[connectedKey] = false\r\n  }\r\n\r\n  static get observedAttributes () { return ['value', 'tab', 'class'] }\r\n}\r\n\r\nfunction rememberSize (element) {\r\n  element[widthKey] = element.clientWidth\r\n  element[heightKey] = element.clientHeight\r\n}\r\n\r\nfunction updateLineNumbers (element) {\r\n  const newWidth = element.clientWidth\r\n  const newHeight = element.clientHeight\r\n  if (newWidth !== element[widthKey] || newHeight !== element[heightKey]) {\r\n    Prism.plugins.lineNumbers.updateLineNumbers(element.shadowRoot.getElementById('source-wrapper'))\r\n    element[widthKey] = newWidth\r\n    element[heightKey] = newHeight\r\n  }\r\n}\r\n\r\nfunction registerEvents (element) {\r\n  const mousedown = element[mousedownKey] = () => rememberSize(element)\r\n  const mouseup = element[mouseupKey] = () => updateLineNumbers(element)\r\n  element.addEventListener('mousedown', mousedown)\r\n  element.addEventListener('mouseup', mouseup)\r\n}\r\n\r\nfunction unregisterEvents (element) {\r\n  element.removeEventListener('mouseup', element[mouseupKey])\r\n  element.removeEventListener('mousedown', element[mousedownKey])\r\n}\r\n\r\nfunction updateAllLineNumbers () {\r\n  clearTimeout(pendingAllLineNumbersUpdate)\r\n  const editors = document.querySelectorAll('graphviz-script-editor.line-numbers')\r\n  for (const editor of editors) updateLineNumbers(editor)\r\n}\r\n\r\nfunction scheduleUpdateAllLineNumbers () {\r\n  if (pendingAllLineNumbersUpdate) clearTimeout(pendingAllLineNumbersUpdate)\r\n  pendingAllLineNumbersUpdate = setTimeout(updateAllLineNumbers, 300)\r\n}\r\n\r\naddEventListener('resize', scheduleUpdateAllLineNumbers)\r\n\r\ncustomElements.define('graphviz-script-editor', GraphvizScriptEditorElement)\r\n\r\nexport default GraphvizScriptEditorElement\r\n","/**\r\n * Prism: Lightweight, robust, elegant syntax highlighting\r\n * MIT license http://www.opensource.org/licenses/mit-license.php/\r\n * @author Lea Verou http://lea.verou.me\r\n */\r\n\r\n// Private helper vars\r\nvar lang = /\\blang(?:uage)?-([\\w-]+)\\b/i;\r\nvar uniqueId = 0;\r\n\r\nvar _\r\nexport default _ = {\r\n\tcodeTag: 'code',\r\n\r\n\tutil: {\r\n\t\tencode: function encode(tokens) {\r\n\t\t\tif (tokens instanceof Token) {\r\n\t\t\t\treturn new Token(tokens.type, encode(tokens.content), tokens.alias);\r\n\t\t\t} else if (Array.isArray(tokens)) {\r\n\t\t\t\treturn tokens.map(encode);\r\n\t\t\t} else {\r\n\t\t\t\treturn tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\u00a0/g, ' ');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttype: function (o) {\r\n\t\t\treturn Object.prototype.toString.call(o).slice(8, -1);\r\n\t\t},\r\n\r\n\t\tobjId: function (obj) {\r\n\t\t\tif (!obj['__id']) {\r\n\t\t\t\tObject.defineProperty(obj, '__id', { value: ++uniqueId });\r\n\t\t\t}\r\n\t\t\treturn obj['__id'];\r\n\t\t},\r\n\r\n\t\t// Deep clone a language definition (e.g. to extend it)\r\n\t\tclone: function deepClone(o, visited) {\r\n\t\t\tvar clone, id, type = _.util.type(o);\r\n\t\t\tvisited = visited || {};\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase 'Object':\r\n\t\t\t\t\tid = _.util.objId(o);\r\n\t\t\t\t\tif (visited[id]) {\r\n\t\t\t\t\t\treturn visited[id];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclone = {};\r\n\t\t\t\t\tvisited[id] = clone;\r\n\r\n\t\t\t\t\tfor (var key in o) {\r\n\t\t\t\t\t\tif (o.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\tclone[key] = deepClone(o[key], visited);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn clone;\r\n\r\n\t\t\t\tcase 'Array':\r\n\t\t\t\t\tid = _.util.objId(o);\r\n\t\t\t\t\tif (visited[id]) {\r\n\t\t\t\t\t\treturn visited[id];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclone = [];\r\n\t\t\t\t\tvisited[id] = clone;\r\n\r\n\t\t\t\t\to.forEach(function (v, i) {\r\n\t\t\t\t\t\tclone[i] = deepClone(v, visited);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn clone;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn o;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Returns the Prism language of the given element set by a `language-xxxx` or `lang-xxxx` class.\r\n\t\t *\r\n\t\t * If no language is set for the element or the element is `null` or `undefined`, `none` will be returned.\r\n\t\t *\r\n\t\t * @param {Element} element\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\tgetLanguage: function (element) {\r\n\t\t\twhile (element && !lang.test(element.className)) {\r\n\t\t\t\telement = element.parentElement;\r\n\t\t\t}\r\n\t\t\tif (element) {\r\n\t\t\t\treturn (element.className.match(lang) || [, 'none'])[1].toLowerCase();\r\n\t\t\t}\r\n\t\t\treturn 'none';\r\n\t\t}\r\n\t},\r\n\r\n\tlanguages: {\r\n\t\textend: function (id, redef) {\r\n\t\t\tvar lang = _.util.clone(_.languages[id]);\r\n\r\n\t\t\tfor (var key in redef) {\r\n\t\t\t\tlang[key] = redef[key];\r\n\t\t\t}\r\n\r\n\t\t\treturn lang;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Insert a token before another token in a language literal\r\n\t\t * As this needs to recreate the object (we cannot actually insert before keys in object literals),\r\n\t\t * we cannot just provide an object, we need an object and a key.\r\n\t\t * @param inside The key (or language id) of the parent\r\n\t\t * @param before The key to insert before.\r\n\t\t * @param insert Object with the key/value pairs to insert\r\n\t\t * @param root The object that contains `inside`. If equal to Prism.languages, it can be omitted.\r\n\t\t */\r\n\t\tinsertBefore: function (inside, before, insert, root) {\r\n\t\t\troot = root || _.languages;\r\n\t\t\tvar grammar = root[inside];\r\n\t\t\tvar ret = {};\r\n\r\n\t\t\tfor (var token in grammar) {\r\n\t\t\t\tif (grammar.hasOwnProperty(token)) {\r\n\r\n\t\t\t\t\tif (token == before) {\r\n\t\t\t\t\t\tfor (var newToken in insert) {\r\n\t\t\t\t\t\t\tif (insert.hasOwnProperty(newToken)) {\r\n\t\t\t\t\t\t\t\tret[newToken] = insert[newToken];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Do not insert token which also occur in insert. See #1525\r\n\t\t\t\t\tif (!insert.hasOwnProperty(token)) {\r\n\t\t\t\t\t\tret[token] = grammar[token];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar old = root[inside];\r\n\t\t\troot[inside] = ret;\r\n\r\n\t\t\t// Update references in other language definitions\r\n\t\t\t_.languages.DFS(_.languages, function(key, value) {\r\n\t\t\t\tif (value === old && key != inside) {\r\n\t\t\t\t\tthis[key] = ret;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn ret;\r\n\t\t},\r\n\r\n\t\t// Traverse a language definition with Depth First Search\r\n\t\tDFS: function DFS(o, callback, type, visited) {\r\n\t\t\tvisited = visited || {};\r\n\r\n\t\t\tvar objId = _.util.objId;\r\n\r\n\t\t\tfor (var i in o) {\r\n\t\t\t\tif (o.hasOwnProperty(i)) {\r\n\t\t\t\t\tcallback.call(o, i, o[i], type || i);\r\n\r\n\t\t\t\t\tvar property = o[i],\r\n\t\t\t\t\t    propertyType = _.util.type(property);\r\n\r\n\t\t\t\t\tif (propertyType === 'Object' && !visited[objId(property)]) {\r\n\t\t\t\t\t\tvisited[objId(property)] = true;\r\n\t\t\t\t\t\tDFS(property, callback, null, visited);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (propertyType === 'Array' && !visited[objId(property)]) {\r\n\t\t\t\t\t\tvisited[objId(property)] = true;\r\n\t\t\t\t\t\tDFS(property, callback, i, visited);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tplugins: {},\r\n\r\n\thighlightElement: function(element, callback) {\r\n\t\t// Find language\r\n\t\tvar language = _.util.getLanguage(element);\r\n\t\tvar grammar = _.languages[language];\r\n\r\n\t\t// Set language on the element, if not present\r\n\t\telement.className = element.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\r\n\r\n\t\t// Set language on the parent, for styling\r\n\t\tvar parent = element.parentNode;\r\n\t\tif (parent && parent.nodeName.toLowerCase() === 'pre') {\r\n\t\t\tparent.className = parent.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\r\n\t\t}\r\n\r\n\t\tvar code = element.textContent;\r\n\r\n\t\tvar env = {\r\n\t\t\telement: element,\r\n\t\t\tlanguage: language,\r\n\t\t\tgrammar: grammar,\r\n\t\t\tcode: code\r\n\t\t};\r\n\r\n\t\tfunction insertHighlightedCode(highlightedCode) {\r\n\t\t\tenv.highlightedCode = highlightedCode;\r\n\r\n\t\t\t_.hooks.run('before-insert', env);\r\n\r\n\t\t\tenv.element.innerHTML = env.highlightedCode;\r\n\r\n\t\t\t_.hooks.run('after-highlight', env);\r\n\t\t\t_.hooks.run('complete', env);\r\n\t\t\tcallback && callback.call(env.element);\r\n\t\t}\r\n\r\n\t\t_.hooks.run('before-sanity-check', env);\r\n\r\n\t\tif (!env.code) {\r\n\t\t\t_.hooks.run('complete', env);\r\n\t\t\tcallback && callback.call(env.element);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_.hooks.run('before-highlight', env);\r\n\r\n\t\tif (!env.grammar) {\r\n\t\t\tinsertHighlightedCode(_.util.encode(env.code));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tinsertHighlightedCode(_.highlight(env.code, env.grammar, env.language));\r\n\t},\r\n\r\n\thighlight: function (text, grammar, language) {\r\n\t\tvar env = {\r\n\t\t\tcode: text,\r\n\t\t\tgrammar: grammar,\r\n\t\t\tlanguage: language\r\n\t\t};\r\n\t\t_.hooks.run('before-tokenize', env);\r\n\t\tenv.tokens = _.tokenize(env.code, env.grammar);\r\n\t\t_.hooks.run('after-tokenize', env);\r\n\t\treturn Token.stringify(_.util.encode(env.tokens), env.language);\r\n\t},\r\n\r\n\ttokenize: function(text, grammar) {\r\n\t\tvar rest = grammar.rest;\r\n\t\tif (rest) {\r\n\t\t\tfor (var token in rest) {\r\n\t\t\t\tgrammar[token] = rest[token];\r\n\t\t\t}\r\n\r\n\t\t\tdelete grammar.rest;\r\n\t\t}\r\n\r\n\t\tvar tokenList = new LinkedList();\r\n\t\taddAfter(tokenList, tokenList.head, text);\r\n\r\n\t\tmatchGrammar(text, tokenList, grammar, tokenList.head, 0);\r\n\r\n\t\treturn toArray(tokenList);\r\n\t},\r\n\r\n\thooks: {\r\n\t\tall: {},\r\n\r\n\t\tadd: function (name, callback) {\r\n\t\t\tvar hooks = _.hooks.all;\r\n\r\n\t\t\thooks[name] = hooks[name] || [];\r\n\r\n\t\t\thooks[name].push(callback);\r\n\t\t},\r\n\r\n\t\trun: function (name, env) {\r\n\t\t\tvar callbacks = _.hooks.all[name];\r\n\r\n\t\t\tif (!callbacks || !callbacks.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i=0, callback; callback = callbacks[i++];) {\r\n\t\t\t\tcallback(env);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tToken: Token\r\n};\r\n\r\nfunction Token(type, content, alias, matchedStr, greedy) {\r\n\tthis.type = type;\r\n\tthis.content = content;\r\n\tthis.alias = alias;\r\n\t// Copy of the full string this token was created from\r\n\tthis.length = (matchedStr || '').length|0;\r\n\tthis.greedy = !!greedy;\r\n}\r\n\r\nToken.stringify = function stringify(o, language) {\r\n\tif (typeof o == 'string') {\r\n\t\treturn o;\r\n\t}\r\n\tif (Array.isArray(o)) {\r\n\t\tvar s = '';\r\n\t\to.forEach(function (e) {\r\n\t\t\ts += stringify(e, language);\r\n\t\t});\r\n\t\treturn s;\r\n\t}\r\n\r\n\tvar env = {\r\n\t\ttype: o.type,\r\n\t\tcontent: stringify(o.content, language),\r\n\t\ttag: 'span',\r\n\t\tclasses: ['token', o.type],\r\n\t\tattributes: {},\r\n\t\tlanguage: language\r\n\t};\r\n\r\n\tvar aliases = o.alias;\r\n\tif (aliases) {\r\n\t\tif (Array.isArray(aliases)) {\r\n\t\t\tArray.prototype.push.apply(env.classes, aliases);\r\n\t\t} else {\r\n\t\t\tenv.classes.push(aliases);\r\n\t\t}\r\n\t}\r\n\r\n\t_.hooks.run('wrap', env);\r\n\r\n\tvar attributes = '';\r\n\tfor (var name in env.attributes) {\r\n\t\tattributes += ' ' + name + '=\"' + (env.attributes[name] || '').replace(/\"/g, '&quot;') + '\"';\r\n\t}\r\n\r\n\treturn '<' + env.tag + ' class=\"' + env.classes.join(' ') + '\"' + attributes + '>' + env.content + '</' + env.tag + '>';\r\n};\r\n\r\n/**\r\n * @param {string} text\r\n * @param {LinkedList<string | Token>} tokenList\r\n * @param {any} grammar\r\n * @param {LinkedListNode<string | Token>} startNode\r\n * @param {number} startPos\r\n * @param {boolean} [oneshot=false]\r\n * @param {string} [target]\r\n */\r\nfunction matchGrammar(text, tokenList, grammar, startNode, startPos, oneshot, target) {\r\n\tfor (var token in grammar) {\r\n\t\tif (!grammar.hasOwnProperty(token) || !grammar[token]) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar patterns = grammar[token];\r\n\t\tpatterns = Array.isArray(patterns) ? patterns : [patterns];\r\n\r\n\t\tfor (var j = 0; j < patterns.length; ++j) {\r\n\t\t\tif (target && target == token + ',' + j) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar pattern = patterns[j],\r\n\t\t\t\tinside = pattern.inside,\r\n\t\t\t\tlookbehind = !!pattern.lookbehind,\r\n\t\t\t\tgreedy = !!pattern.greedy,\r\n\t\t\t\tlookbehindLength = 0,\r\n\t\t\t\talias = pattern.alias;\r\n\r\n\t\t\tif (greedy && !pattern.pattern.global) {\r\n\t\t\t\t// Without the global flag, lastIndex won't work\r\n\t\t\t\tvar flags = pattern.pattern.toString().match(/[imsuy]*$/)[0];\r\n\t\t\t\tpattern.pattern = RegExp(pattern.pattern.source, flags + 'g');\r\n\t\t\t}\r\n\r\n\t\t\tpattern = pattern.pattern || pattern;\r\n\r\n\t\t\tfor ( // iterate the token list and keep track of the current token/string position\r\n\t\t\t\tvar currentNode = startNode.next, pos = startPos;\r\n\t\t\t\tcurrentNode !== tokenList.tail;\r\n\t\t\t\tpos += currentNode.value.length, currentNode = currentNode.next\r\n\t\t\t) {\r\n\r\n\t\t\t\tvar str = currentNode.value;\r\n\r\n\t\t\t\tif (tokenList.length > text.length) {\r\n\t\t\t\t\t// Something went terribly wrong, ABORT, ABORT!\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (str instanceof Token) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar removeCount = 1; // this is the to parameter of removeBetween\r\n\r\n\t\t\t\tif (greedy && currentNode != tokenList.tail.prev) {\r\n\t\t\t\t\tpattern.lastIndex = pos;\r\n\t\t\t\t\tvar match = pattern.exec(text);\r\n\t\t\t\t\tif (!match) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar from = match.index + (lookbehind && match[1] ? match[1].length : 0);\r\n\t\t\t\t\tvar to = match.index + match[0].length;\r\n\t\t\t\t\tvar p = pos;\r\n\r\n\t\t\t\t\t// find the node that contains the match\r\n\t\t\t\t\tp += currentNode.value.length;\r\n\t\t\t\t\twhile (from >= p) {\r\n\t\t\t\t\t\tcurrentNode = currentNode.next;\r\n\t\t\t\t\t\tp += currentNode.value.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// adjust pos (and p)\r\n\t\t\t\t\tp -= currentNode.value.length;\r\n\t\t\t\t\tpos = p;\r\n\r\n\t\t\t\t\t// the current node is a Token, then the match starts inside another Token, which is invalid\r\n\t\t\t\t\tif (currentNode.value instanceof Token) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// find the last node which is affected by this match\r\n\t\t\t\t\tfor (\r\n\t\t\t\t\t\tvar k = currentNode;\r\n\t\t\t\t\t\tk !== tokenList.tail && (p < to || (typeof k.value === 'string' && !k.prev.value.greedy));\r\n\t\t\t\t\t\tk = k.next\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tremoveCount++;\r\n\t\t\t\t\t\tp += k.value.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tremoveCount--;\r\n\r\n\t\t\t\t\t// replace with the new match\r\n\t\t\t\t\tstr = text.slice(pos, p);\r\n\t\t\t\t\tmatch.index -= pos;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpattern.lastIndex = 0;\r\n\r\n\t\t\t\t\tvar match = pattern.exec(str);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!match) {\r\n\t\t\t\t\tif (oneshot) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (lookbehind) {\r\n\t\t\t\t\tlookbehindLength = match[1] ? match[1].length : 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar from = match.index + lookbehindLength,\r\n\t\t\t\t\tmatch = match[0].slice(lookbehindLength),\r\n\t\t\t\t\tto = from + match.length,\r\n\t\t\t\t\tbefore = str.slice(0, from),\r\n\t\t\t\t\tafter = str.slice(to);\r\n\r\n\t\t\t\tvar removeFrom = currentNode.prev;\r\n\r\n\t\t\t\tif (before) {\r\n\t\t\t\t\tremoveFrom = addAfter(tokenList, removeFrom, before);\r\n\t\t\t\t\tpos += before.length;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tremoveRange(tokenList, removeFrom, removeCount);\r\n\r\n\t\t\t\tvar wrapped = new Token(token, inside ? _.tokenize(match, inside) : match, alias, match, greedy);\r\n\t\t\t\tcurrentNode = addAfter(tokenList, removeFrom, wrapped);\r\n\r\n\t\t\t\tif (after) {\r\n\t\t\t\t\taddAfter(tokenList, currentNode, after);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif (removeCount > 1)\r\n\t\t\t\t\tmatchGrammar(text, tokenList, grammar, currentNode.prev, pos, true, token + ',' + j);\r\n\r\n\t\t\t\tif (oneshot)\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @typedef LinkedListNode\r\n * @property {T} value\r\n * @property {LinkedListNode<T> | null} prev The previous node.\r\n * @property {LinkedListNode<T> | null} next The next node.\r\n * @template T\r\n */\r\n\r\n/**\r\n * @template T\r\n */\r\nfunction LinkedList() {\r\n\t/** @type {LinkedListNode<T>} */\r\n\tvar head = { value: null, prev: null, next: null };\r\n\t/** @type {LinkedListNode<T>} */\r\n\tvar tail = { value: null, prev: head, next: null };\r\n\thead.next = tail;\r\n\r\n\t/** @type {LinkedListNode<T>} */\r\n\tthis.head = head;\r\n\t/** @type {LinkedListNode<T>} */\r\n\tthis.tail = tail;\r\n\tthis.length = 0;\r\n}\r\n\r\n/**\r\n * Adds a new node with the given value to the list.\r\n * @param {LinkedList<T>} list\r\n * @param {LinkedListNode<T>} node\r\n * @param {T} value\r\n * @returns {LinkedListNode<T>} The added node.\r\n * @template T\r\n */\r\nfunction addAfter(list, node, value) {\r\n\t// assumes that node != list.tail && values.length >= 0\r\n\tvar next = node.next;\r\n\r\n\tvar newNode = { value: value, prev: node, next: next };\r\n\tnode.next = newNode;\r\n\tnext.prev = newNode;\r\n\tlist.length++;\r\n\r\n\treturn newNode;\r\n}\r\n/**\r\n * Removes `count` nodes after the given node. The given node will not be removed.\r\n * @param {LinkedList<T>} list\r\n * @param {LinkedListNode<T>} node\r\n * @param {number} count\r\n * @template T\r\n */\r\nfunction removeRange(list, node, count) {\r\n\tvar next = node.next;\r\n\tfor (var i = 0; i < count && next !== list.tail; i++) {\r\n\t\tnext = next.next;\r\n\t}\r\n\tnode.next = next;\r\n\tnext.prev = node;\r\n\tlist.length -= i;\r\n}\r\n/**\r\n * @param {LinkedList<T>} list\r\n * @returns {T[]}\r\n * @template T\r\n */\r\nfunction toArray(list) {\r\n\tvar array = [];\r\n\tvar node = list.head.next;\r\n\twhile (node !== list.tail) {\r\n\t\tarray.push(node.value);\r\n\t\tnode = node.next;\r\n\t}\r\n\treturn array;\r\n}\r\n","import Prism from './prism-core'\r\n\r\n/**\r\n * Plugin name which is used as a class name for <pre> which is activating the plugin\r\n * @type {String}\r\n */\r\nvar PLUGIN_NAME = 'line-numbers';\r\n\r\n/**\r\n * Regular expression used for determining line breaks\r\n * @type {RegExp}\r\n */\r\nvar NEW_LINE_EXP = /\\n(?!$)/g;\r\n\r\n/**\r\n * Resizes line numbers spans according to height of line of code\r\n * @param {Element} element <pre> element\r\n */\r\nvar _resizeElement = function (element) {\r\n\tvar codeStyles = getStyles(element);\r\n\tvar whiteSpace = codeStyles['white-space'];\r\n\r\n\tif (whiteSpace === 'pre-wrap' || whiteSpace === 'pre-line') {\r\n\t\tvar codeElement = element.querySelector(Prism.codeTag);\r\n\t\tvar lineNumbersWrapper = element.querySelector('.line-numbers-rows');\r\n\t\tvar lineNumberSizer = element.querySelector('.line-numbers-sizer');\r\n\t\tvar codeLines = codeElement.textContent.split(NEW_LINE_EXP);\r\n\r\n\t\tif (!lineNumberSizer) {\r\n\t\t\tlineNumberSizer = document.createElement('span');\r\n\t\t\tlineNumberSizer.className = 'line-numbers-sizer';\r\n\r\n\t\t\tcodeElement.appendChild(lineNumberSizer);\r\n\t\t}\r\n\r\n\t\tlineNumberSizer.style.display = 'block';\r\n\r\n\t\tcodeLines.forEach(function (line, lineNumber) {\r\n\t\t\tlineNumberSizer.textContent = line || '\\n';\r\n\t\t\tvar lineSize = lineNumberSizer.getBoundingClientRect().height;\r\n\t\t\tlineNumbersWrapper.children[lineNumber].style.height = lineSize + 'px';\r\n\t\t});\r\n\r\n\t\tlineNumberSizer.textContent = '';\r\n\t\tlineNumberSizer.style.display = 'none';\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns style declarations for the element\r\n * @param {Element} element\r\n */\r\nvar getStyles = function (element) {\r\n\tif (!element) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn window.getComputedStyle ? getComputedStyle(element) : (element.currentStyle || null);\r\n};\r\n\r\nPrism.hooks.add('complete', function (env) {\r\n\tif (!env.code) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar code = env.element;\r\n\tvar pre = code.parentNode;\r\n\r\n\t// works only for <code> wrapped inside <pre> (not inline)\r\n\tif (!pre || !/pre/i.test(pre.nodeName)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Abort if line numbers already exists\r\n\tif (code.querySelector('.line-numbers-rows')) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar addLineNumbers = false;\r\n\tvar lineNumbersRegex = /(?:^|\\s)line-numbers(?:\\s|$)/;\r\n\r\n\tfor (var element = code; element; element = element.parentNode) {\r\n\t\tif (lineNumbersRegex.test(element.className)) {\r\n\t\t\taddLineNumbers = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t// only add line numbers if <code> or one of its ancestors has the `line-numbers` class\r\n\tif (!addLineNumbers) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Remove the class 'line-numbers' from the <code>\r\n\tcode.className = code.className.replace(lineNumbersRegex, ' ');\r\n\t// Add the class 'line-numbers' to the <pre>\r\n\tif (!lineNumbersRegex.test(pre.className)) {\r\n\t\tpre.className += ' line-numbers';\r\n\t}\r\n\r\n\tvar match = env.code.match(NEW_LINE_EXP);\r\n\tvar linesNum = match ? match.length + 1 : 1;\r\n\tvar lineNumbersWrapper;\r\n\r\n\tvar lines = new Array(linesNum + 1).join('<span></span>');\r\n\r\n\tlineNumbersWrapper = document.createElement('span');\r\n\tlineNumbersWrapper.setAttribute('aria-hidden', 'true');\r\n\tlineNumbersWrapper.className = 'line-numbers-rows';\r\n\tlineNumbersWrapper.innerHTML = lines;\r\n\r\n\tif (pre.hasAttribute('data-start')) {\r\n\t\tpre.style.counterReset = 'linenumber ' + (parseInt(pre.getAttribute('data-start'), 10) - 1);\r\n\t}\r\n\r\n\tenv.element.appendChild(lineNumbersWrapper);\r\n\r\n\t_resizeElement(pre);\r\n\r\n\tPrism.hooks.run('line-numbers', env);\r\n});\r\n\r\nPrism.hooks.add('line-numbers', function (env) {\r\n\tenv.plugins = env.plugins || {};\r\n\tenv.plugins.lineNumbers = true;\r\n});\r\n\r\n/**\r\n * Global exports\r\n */\r\nPrism.plugins.lineNumbers = {\r\n\t/**\r\n\t * Update line numbers after resizing the text area by mouse\r\n\t * @param {Element} element pre element\r\n\t * @return {undefined}\r\n\t */\r\n\tupdateLineNumbers: function(element) {\r\n\t\t_resizeElement(element);\r\n\t},\r\n\t/**\r\n\t * Get node for provided line number\r\n\t * @param {Element} element pre element\r\n\t * @param {Number} number line number\r\n\t * @return {Element|undefined}\r\n\t */\r\n\tgetLine: function (element, number) {\r\n\t\tif (element.tagName !== 'PRE' || !element.classList.contains(PLUGIN_NAME)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar lineNumberRows = element.querySelector('.line-numbers-rows');\r\n\t\tvar lineNumberStart = parseInt(element.getAttribute('data-start'), 10) || 1;\r\n\t\tvar lineNumberEnd = lineNumberStart + (lineNumberRows.children.length - 1);\r\n\r\n\t\tif (number < lineNumberStart) {\r\n\t\t\tnumber = lineNumberStart;\r\n\t\t}\r\n\t\tif (number > lineNumberEnd) {\r\n\t\t\tnumber = lineNumberEnd;\r\n\t\t}\r\n\r\n\t\tvar lineIndex = number - lineNumberStart;\r\n\r\n\t\treturn lineNumberRows.children[lineIndex];\r\n\t}\r\n};\r\n","import Prism from './prism-core'\r\n\r\nvar MATCH_ALL_CLASS = /(?:^|\\s)match-braces(?:\\s|$)/;\r\n\r\nvar BRACE_HOVER_CLASS = /(?:^|\\s)brace-hover(?:\\s|$)/;\r\nvar BRACE_SELECTED_CLASS = /(?:^|\\s)brace-selected(?:\\s|$)/;\r\n\r\nvar NO_BRACE_HOVER_CLASS = /(?:^|\\s)no-brace-hover(?:\\s|$)/;\r\nvar NO_BRACE_SELECT_CLASS = /(?:^|\\s)no-brace-select(?:\\s|$)/;\r\n\r\nvar PARTNER = {\r\n\t'(': ')',\r\n\t'[': ']',\r\n\t'{': '}',\r\n};\r\n\r\nvar NAMES = {\r\n\t'(': 'brace-round',\r\n\t'[': 'brace-square',\r\n\t'{': 'brace-curly',\r\n};\r\n\r\nvar LEVEL_WARP = 12;\r\n\r\nvar pairIdCounter = 0;\r\n\r\nvar BRACE_ID_PATTERN = /^(pair-\\d+-)(open|close)$/;\r\n\r\n/**\r\n * Returns the brace partner given one brace of a brace pair.\r\n *\r\n * @param {HTMLElement} brace\r\n * @returns {HTMLElement}\r\n */\r\nfunction getPartnerBrace(brace) {\r\n\tvar match = BRACE_ID_PATTERN.exec(brace.id);\r\n\treturn brace.parentElement.querySelector('#' + match[1] + (match[2] == 'open' ? 'close' : 'open'));\r\n}\r\n\r\n/**\r\n * @this {HTMLElement}\r\n */\r\nfunction hoverBrace() {\r\n\tfor (var parent = this.parentElement; parent; parent = parent.parentElement) {\r\n\t\tif (NO_BRACE_HOVER_CLASS.test(parent.className)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\r\n\t\tele.className = (ele.className.replace(BRACE_HOVER_CLASS, ' ') + ' brace-hover').replace(/\\s+/g, ' ');\r\n\t});\r\n}\r\n/**\r\n * @this {HTMLElement}\r\n */\r\nfunction leaveBrace() {\r\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\r\n\t\tele.className = ele.className.replace(BRACE_HOVER_CLASS, ' ');\r\n\t});\r\n}\r\n/**\r\n * @this {HTMLElement}\r\n */\r\nfunction clickBrace() {\r\n\tfor (var parent = this.parentElement; parent; parent = parent.parentElement) {\r\n\t\tif (NO_BRACE_SELECT_CLASS.test(parent.className)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\r\n\t\tele.className = (ele.className.replace(BRACE_SELECTED_CLASS, ' ') + ' brace-selected').replace(/\\s+/g, ' ');\r\n\t});\r\n}\r\n\r\nPrism.hooks.add('complete', function (env) {\r\n\r\n\t/** @type {HTMLElement} */\r\n\tvar code = env.element;\r\n\tvar pre = code.parentElement;\r\n\r\n\tif (!pre || pre.tagName != 'PRE') {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// find the braces to match\r\n\t/** @type {string[]} */\r\n\tvar toMatch = [];\r\n\tfor (var ele = code; ele; ele = ele.parentElement) {\r\n\t\tif (MATCH_ALL_CLASS.test(ele.className)) {\r\n\t\t\ttoMatch.push('(', '[', '{');\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif (toMatch.length == 0) {\r\n\t\t// nothing to match\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!pre.__listenerAdded) {\r\n\t\t// code blocks might be highlighted more than once\r\n\t\tpre.addEventListener('mousedown', function removeBraceSelected() {\r\n\t\t\t// the code element might have been replaced\r\n\t\t\tvar code = pre.querySelector(Prism.codeTag);\r\n\t\t\tArray.prototype.slice.call(code.querySelectorAll('.brace-selected')).forEach(function (element) {\r\n\t\t\t\telement.className = element.className.replace(BRACE_SELECTED_CLASS, ' ');\r\n\t\t\t});\r\n\t\t});\r\n\t\tObject.defineProperty(pre, '__listenerAdded', { value: true });\r\n\t}\r\n\r\n\t/** @type {HTMLSpanElement[]} */\r\n\tvar punctuation = Array.prototype.slice.call(code.querySelectorAll('span.token.punctuation'));\r\n\r\n\t/** @type {{ index: number, open: boolean, element: HTMLElement }[]} */\r\n\tvar allBraces = [];\r\n\r\n\ttoMatch.forEach(function (open) {\r\n\t\tvar close = PARTNER[open];\r\n\t\tvar name = NAMES[open];\r\n\r\n\t\t/** @type {[number, number][]} */\r\n\t\tvar pairs = [];\r\n\t\t/** @type {number[]} */\r\n\t\tvar openStack = [];\r\n\r\n\t\tfor (var i = 0; i < punctuation.length; i++) {\r\n\t\t\tvar element = punctuation[i];\r\n\t\t\tif (element.childElementCount == 0) {\r\n\t\t\t\tvar text = element.textContent;\r\n\t\t\t\tif (text === open) {\r\n\t\t\t\t\tallBraces.push({ index: i, open: true, element: element });\r\n\t\t\t\t\telement.className += ' ' + name;\r\n\t\t\t\t\telement.className += ' brace-open';\r\n\t\t\t\t\topenStack.push(i);\r\n\t\t\t\t} else if (text === close) {\r\n\t\t\t\t\tallBraces.push({ index: i, open: false, element: element });\r\n\t\t\t\t\telement.className += ' ' + name;\r\n\t\t\t\t\telement.className += ' brace-close';\r\n\t\t\t\t\tif (openStack.length) {\r\n\t\t\t\t\t\tpairs.push([i, openStack.pop()]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpairs.forEach(function (pair) {\r\n\t\t\tvar pairId = 'pair-' + (pairIdCounter++) + '-';\r\n\r\n\t\t\tvar openEle = punctuation[pair[0]];\r\n\t\t\tvar closeEle = punctuation[pair[1]];\r\n\r\n\t\t\topenEle.id = pairId + 'open';\r\n\t\t\tcloseEle.id = pairId + 'close';\r\n\r\n\t\t\t[openEle, closeEle].forEach(function (ele) {\r\n\t\t\t\tele.addEventListener('mouseenter', hoverBrace);\r\n\t\t\t\tele.addEventListener('mouseleave', leaveBrace);\r\n\t\t\t\tele.addEventListener('click', clickBrace);\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\r\n\tvar level = 0;\r\n\tallBraces.sort(function (a, b) { return a.index - b.index; });\r\n\tallBraces.forEach(function (brace) {\r\n\t\tif (brace.open) {\r\n\t\t\tbrace.element.className += ' brace-level-' + (level % LEVEL_WARP + 1);\r\n\t\t\tlevel++;\r\n\t\t} else {\r\n\t\t\tlevel = Math.max(0, level - 1);\r\n\t\t\tbrace.element.className += ' brace-level-' + (level % LEVEL_WARP + 1);\r\n\t\t}\r\n\t});\r\n\r\n});\r\n","import Prism from './prism-core'\r\n\r\nPrism.languages.graphviz = {\r\n  comment: [{\r\n    pattern: /\\/\\/(?:[^\\r\\n\\\\]|\\\\(?:\\r\\n?|\\n|(?![\\r\\n])))*|\\/\\*[\\s\\S]*?(?:\\*\\/|$)/,\r\n    greedy: true\r\n  }, {\r\n    pattern: /(^|[^\\\\:])\\/\\/.*/,\r\n    lookbehind: !0,\r\n    greedy: !0\r\n  }],\r\n  string: {\r\n    pattern: /([\"'])(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/,\r\n    greedy: !0\r\n  },\r\n  'class-name': {\r\n    pattern: /(\\b(?:digraph|graph)\\s+)\\w+/,\r\n    lookbehind: true\r\n  },\r\n  keyword: /\\b(?:digraph|graph|node|edge)\\b/,\r\n  property: /\\b(?:Damping|URL|area|arrowhead|arrowsize|arrowtail|aspect|bb|bgcolor|center|charset|clusterrank|color|colorscheme|comment|compound|concentrate|constraint|decorate|defaultdist|dim|dimen|dir|diredgeconstraints|distortion|dpi|edgeURL|edgehref|edgetarget|edgetooltip|epsilon|esep|fillcolor|fixedsize|fontcolor|fontname|fontnames|fontpath|fontsize|group|headURL|headclip|headhref|headlabel|headport|headtarget|headtooltip|height|href|id|image|imagepath|imagescale|label|labelURL|labelangle|labeldistance|labelfloat|labelfontcolor|labelfontname|labelfontsize|labelhref|labeljust|labelloc|labeltarget|labeltooltip|landscape|layer|layerlistsep|layers|layerselect|layersep|layout|len|levels|levelsgap|lhead|lheight|lp|ltail|lwidth|margin|maxiter|mclimit|mindist|minlen|mode|model|mosek|nodesep|nojustify|normalize|nslimit|nslimit1|ordering|orientation|outputorder|overlap|overlap_scaling|pack|packmode|pad|page|pagedir|pencolor|penwidth|peripheries|pin|pos|quadtree|quantum|rank|rankdir|ranksep|ratio|rects|regular|remincross|repulsiveforce|resolution|root|rotate|rotation|samehead|sametail|samplepoints|scale|searchsize|sep|shape|shapefile|showboxes|sides|size|skew|smoothing|sortv|splines|start|style|stylesheet|tail_lp|tailURL|tailclip|tailhref|taillabel|tailport|tailtarget|tailtooltip|target|tooltip|truecolor|vertices|viewport|voro_margin|weight|width|xlabel)\\b/,\r\n  constant: /\\b(?:dot|neato|fdp|sfdp|twopi|circo|osage|patchwork|LR|RL|TB|BT|box|polygon|ellipse|oval|circle|point|egg|triangle|plaintext|plain|diamond|trapezium|parallelogram|house|pentagon|hexagon|septagon|octagon|doublecircle|doubleoctagon|tripleoctagon|invtriangle|invtrapezium|invhouse|Mdiamond|Msquare|Mcircle|rect|rectangle|square|star|none|underline|cylinder|note|tab|folder|box3d|component|promoter|cds|terminator|utr|primersite|restrictionsite|fivepoverhang|threepoverhang|noverhang|assembly|signature|insulator|ribosite|rnastab|proteasesite|proteinstab|rpromoter|rarrow|larrow|lpromoter|solid|dashed|dotted|bold|rounded|diagonals|filled|striped|wedged)\\b/,\r\n  boolean: /\\b(?:true|yes|false|no)\\b/,\r\n  number: /\\b0x[\\da-f]+\\b|(?:\\b\\d+\\.?\\d*|\\B\\.\\d+)(?:e[+-]?\\d+)?/i,\r\n  operator: /->|--|=/,\r\n  punctuation: /[{}[\\];(),.:]/\r\n}\r\n"],"names":["template","pendingAllLineNumbersUpdate","CodeJar","editor","highlight","opt","callback","prev","options","Object","assign","tab","ownerRoot","window","getSelection","ownerDocument","Error","listeners","history","at","focus","isFirefox","navigator","userAgent","toLowerCase","indexOf","setAttribute","style","outline","overflowWrap","overflowY","resize","whiteSpace","debounceHighlight","debounce","pos","save","restore","recording","shouldRecord","event","isUndo","isRedo","key","startsWith","debounceRecordHistory","recordHistory","on","type","fn","push","addEventListener","s","start","end","dir","undefined","visit","el","anchorNode","focusNode","anchorOffset","focusOffset","nodeType","Node","TEXT_NODE","nodeValue","length","startNode","startOffset","endNode","endOffset","current","len","setBaseAndExtent","beforeCursor","r0","getRangeAt","r","document","createRange","selectNodeContents","setEnd","startContainer","toString","afterCursor","setStart","endContainer","html","innerHTML","lastRecord","splice","visitor","queue","firstChild","pop","nextSibling","isCtrl","metaKey","ctrlKey","shiftKey","code","insert","text","replace","execCommand","cb","wait","timeout","args","clearTimeout","setTimeout","findPadding","i","j","test","substring","textContent","preventDefault","defaultPrevented","handleNewLine","before","after","padding","newLinePadding","handleTabCharacters","Math","min","handleJumpToBeginningOfLine","endsWith","handleSelfClosingCharacters","open","close","codeAfter","includes","substr","handleUndoRedo","record","isComposing","_event","handlePaste","originalEvent","clipboardData","getData","updateOptions","updateCode","onUpdate","destroy","removeEventListener","_","lang","uniqueId","Prism","codeTag","util","encode","tokens","Token","content","alias","Array","isArray","map","o","prototype","call","slice","objId","obj","defineProperty","value","clone","deepClone","visited","id","hasOwnProperty","forEach","v","getLanguage","element","className","parentElement","match","languages","extend","redef","insertBefore","inside","root","grammar","ret","token","newToken","old","DFS","property","propertyType","plugins","highlightElement","language","parent","parentNode","nodeName","env","insertHighlightedCode","highlightedCode","hooks","run","tokenize","stringify","rest","tokenList","LinkedList","addAfter","head","matchGrammar","toArray","all","add","name","callbacks","matchedStr","greedy","startPos","oneshot","target","patterns","pattern","lookbehind","lookbehindLength","global","flags","RegExp","source","currentNode","next","tail","str","removeCount","lastIndex","exec","from","index","to","p","k","removeFrom","removeRange","wrapped","list","node","newNode","count","array","e","tag","classes","attributes","aliases","apply","join","PLUGIN_NAME","NEW_LINE_EXP","_resizeElement","codeStyles","getStyles","codeElement","querySelector","lineNumbersWrapper","lineNumberSizer","codeLines","split","createElement","appendChild","display","line","lineNumber","lineSize","getBoundingClientRect","height","children","getComputedStyle","currentStyle","pre","addLineNumbers","lineNumbersRegex","lines","linesNum","hasAttribute","counterReset","parseInt","getAttribute","lineNumbers","updateLineNumbers","getLine","number","tagName","classList","contains","lineNumberRows","lineNumberStart","lineNumberEnd","lineIndex","MATCH_ALL_CLASS","BRACE_HOVER_CLASS","BRACE_SELECTED_CLASS","NO_BRACE_HOVER_CLASS","NO_BRACE_SELECT_CLASS","PARTNER","NAMES","LEVEL_WARP","pairIdCounter","BRACE_ID_PATTERN","getPartnerBrace","brace","hoverBrace","ele","leaveBrace","clickBrace","toMatch","__listenerAdded","querySelectorAll","punctuation","allBraces","pairs","openStack","childElementCount","pair","pairId","openEle","closeEle","level","sort","a","b","max","graphviz","comment","string","keyword","constant","boolean","operator","features","connectedKey","Symbol","valueKey","tabKey","classKey","jarKey","widthKey","heightKey","mousedownKey","mouseupKey","getTemplate","lightTheme","lineNumbersStyle","matchBracesStyle","mainStyle","triggerEvent","detail","dispatchEvent","CustomEvent","getFeatureClasses","trim","filter","feature","hasChangedFeatureClass","oldValue","newValue","oldClasses","newClasses","some","normalizeLineBreaks","createEditor","shadowRoot","getElementById","featureClasses","jar","updateEditor","newCode","destroyEditor","rebuildEditor","configureEditor","GraphvizScriptEditorElement","HTMLElement","constructor","attachShadow","mode","cloneNode","attributeChangedCallback","connectedCallback","registerEvents","disconnectedCallback","unregisterEvents","observedAttributes","rememberSize","clientWidth","clientHeight","newWidth","newHeight","mousedown","mouseup","updateAllLineNumbers","editors","scheduleUpdateAllLineNumbers","customElements","define"],"mappings":"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"}